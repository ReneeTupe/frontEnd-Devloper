(self.modernJsonp=self.modernJsonp||[]).push([["64618"],{319869(e,a,t){var n;t.r(a),t.d(a,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardAttribution_pin",selections:[{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};l.hash="610a35d46510240eb58e262c1909310c";let i=l},916600(e,a,t){var n,l,i;t.r(a),t.d(a,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardBody_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[i={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{args:null,kind:"FragmentSpread",name:"RecipeMetadata_recipe"}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null}],storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},i,{args:null,kind:"FragmentSpread",name:"usePinImageUrls_pin"},{args:null,kind:"FragmentSpread",name:"useNormalizePinData_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardAttribution_pin"}],type:"Pin",abstractKey:null};r.hash="81db65fd15680cc0281b801ed4a8cb94";let s=r},279925(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Descriptors_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null}],type:"Pin",abstractKey:null};n.hash="9d15639e8d9dd61426917dc218fbb3a6";let l=n},340813(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FlashlightSpotlightDots_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetStringifiedCommerceAuxData_pin"}],type:"Pin",abstractKey:null};n.hash="3a8409077905af94eb39568e4a5a57fc";let l=n},727533(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"OneBar_oneBarModules",selections:[{alias:"entityId",args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"OneBarModule_oneBarModules"}],type:"OneBarModule",abstractKey:null};n.hash="45cea1099e24f55ebce4abebdb411447";let l=n},306281(e,a,t){var n;t.r(a),t.d(a,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RecipeMetadata_recipe",selections:[{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:n,storageKey:null}],storageKey:null}],type:"RecipeMetadata",abstractKey:null};l.hash="12f77507a9fdec344b44b7e659fa5ac1";let i=l},327310(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsImageContent_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"}],type:"Pin",abstractKey:null};n.hash="727c8ab2c1c256e3b4478a36890f92d6";let l=n},928121(e,a,t){var n,l,i,r,s,o,d,c;t.r(a),t.d(a,{default:()=>p});let u=(n=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],l=[{kind:"Variable",name:"pin",variableName:"pinId"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r=[{kind:"Literal",name:"spec",value:"564x"}],c=[s={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RelatedProductsPageQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[i,{args:null,kind:"FragmentSpread",name:"RelatedProductsPage_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RelatedProductsPageQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"image",args:r,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[s,o,d],storageKey:'images(spec:"564x")'},{alias:"images_564x",args:r,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:c,storageKey:'images(spec:"564x")'},{alias:"images_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:c,storageKey:'images(spec:"736x")'},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:c,storageKey:'images(spec:"orig")'},{alias:"images_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:c,storageKey:'images(spec:"474x")'},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:c,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"b5501bff91fa6a8188c709de27c033e70ef44c5d628e224dff32440e67cc1aed",metadata:{},name:"RelatedProductsPageQuery",operationKind:"query",text:null}});u.hash="0f7b98a1f02dbf8528df0452aa26efd4";let p=u},713055(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsPage_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchPageWithPinData_pin"}],type:"Pin",abstractKey:null};n.hash="91d05676e413b7b47653c2f8fa609093";let l=n},94762(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsUnifiedFeed_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchMasonryGrid_pin"}],type:"Pin",abstractKey:null};n.hash="20c2c7f4ff982fb93a9608faa14f3ed2";let l=n},84216(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthCropperContainer_pin",selections:[{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"FlashlightSpotlightDots_pin"}],type:"Pin",abstractKey:null};n.hash="939d46d8644385a7918ed8179ce77a4c";let l=n},941734(e,a,t){var n,l,i,r,s,o,d,c,u,p,g,h,m,y,f,_,v,k,x,S,b,w,A,F,P,I,j,C;t.r(a),t.d(a,{default:()=>R});let T=(n={defaultValue:!1,kind:"LocalArgument",name:"isCloseupRelatedModulesFeedQuery"},l={defaultValue:null,kind:"LocalArgument",name:"pinId"},i=[{kind:"Variable",name:"pin",variableName:"pinId"}],r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},d=[{kind:"Literal",name:"spec",value:"564x"}],g=[{kind:"Literal",name:"spec",value:"736x"}],h=[p={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],m=[{kind:"Literal",name:"spec",value:"474x"}],y=[{kind:"Literal",name:"spec",value:"236x"}],f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},v=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],x={alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:k=[r],storageKey:null},S={alias:"images_236x",args:y,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:k,storageKey:'additionalImagesPerSpec(spec:"236x")'},b={alias:"images_474x",args:m,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:k,storageKey:'additionalImagesPerSpec(spec:"474x")'},w={alias:"images_564x",args:d,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:k,storageKey:'additionalImagesPerSpec(spec:"564x")'},A={alias:"images_736x",args:g,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:k,storageKey:'additionalImagesPerSpec(spec:"736x")'},F={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},C=[u],{fragment:{argumentDefinitions:[n,l],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPageFetchData_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n],kind:"Operation",name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:i,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},s,{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},o],storageKey:null},{alias:"images_564x",args:d,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,u,p],storageKey:'images(spec:"564x")'},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,u,p,r],storageKey:'images(spec:"orig")'},{alias:"images_736x",args:g,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"736x")'},{alias:"images_474x",args:m,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"474x")'},{alias:"images_236x",args:y,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},s,o,{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[f,{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[_,{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:v,storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:v,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[r,f,x],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[f,x,{alias:null,args:null,kind:"ScalarField",name:"itemId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"itemSetId",storageKey:null},S,b,w,A],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[F,P,I],storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null},I,r],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},j,{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},_,{alias:"images_60x60",args:[{kind:"Literal",name:"spec",value:"60x60"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:C,storageKey:'images(spec:"60x60")'},{alias:"images_136x136",args:[{kind:"Literal",name:"spec",value:"136x136"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:C,storageKey:'images(spec:"136x136")'},{alias:"images_170x",args:[{kind:"Literal",name:"spec",value:"170x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:C,storageKey:'images(spec:"170x")'},{alias:"images_600x315",args:[{kind:"Literal",name:"spec",value:"600x315"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:C,storageKey:'images(spec:"600x315")'},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null},{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[j,f,{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},u,I],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[j,P,{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},F,I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOosProduct",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStaleProduct",storageKey:null},{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"Brand",kind:"LinkedField",name:"brand",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"signature",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ShippingInfo",kind:"LinkedField",name:"shippingInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"freeShippingPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeShippingValue",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariantSet",kind:"LinkedField",name:"variantSet",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionMetadata",kind:"LinkedField",name:"dimensionMetadata",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"values",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariant",kind:"LinkedField",name:"variants",plural:!0,selections:k,storageKey:null}],storageKey:null},S,b,w,A],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductMetadataV2",kind:"LinkedField",name:"productPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"ItemMetadata",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"additionalImagesLength",storageKey:null}],storageKey:null},I],storageKey:null}]},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:k,storageKey:null},I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shoppingFlags",storageKey:null},{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isShopTheLook",storageKey:null},I],storageKey:null},I],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"fb550a7903e1c94dab6ed839ac53e7e4c46758b281730d89dc05a524e3e0ae23",metadata:{},name:"UnauthDesktopFlashlightPageFetchDataPinQuery",operationKind:"query",text:null}});T.hash="76ab21d7bfe8df8a1418aea805bb41fa";let R=T},281815(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchData_pin",selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPage_pin"}],type:"Pin",abstractKey:null};n.hash="01839fc3bcd9cdaf206873364167d157";let l=n},773353(e,a,t){var n;t.r(a),t.d(a,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{alias:"images_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardBody_pin"},{args:null,kind:"FragmentSpread",name:"UnauthCropperContainer_pin"}],type:"Pin",abstractKey:null};l.hash="0193da1983487c7c302a6a09a3f34b0a";let i=l},193933(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCarousel_story",selections:[{alias:null,args:null,concreteType:"StoryAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentIds",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:"storyId",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackingParams",storageKey:null},{args:null,kind:"FragmentSpread",name:"CSSCarouselModule_story"}],type:"Story",abstractKey:null};n.hash="b1061aefab46af37d4c9716916386af2";let l=n},316564(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsImageContent_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsUnifiedFeed_pin"}],type:"Pin",abstractKey:null};n.hash="3a9a747c3135f426fe0cf32ca9147a5d";let l=n},108026(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCropper_pin",selections:[{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"useSamSegmentation_pin"}],type:"Pin",abstractKey:null};n.hash="fbf2d3b93402a9dd783073db316c0f92";let l=n},473717(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchImageContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"}],type:"Pin",abstractKey:null};n.hash="8250aa2ed9c603023c2f2a226d0b9fbb";let l=n},148963(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchLayout_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchImageContainer_pin"}],type:"Pin",abstractKey:null};n.hash="3c3f391c3bf9eec79c18ed9a3fe63800";let l=n},897853(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchPageWithPinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchContainer_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchLayout_pin"}],type:"Pin",abstractKey:null};n.hash="ece11b62e2de551b92d24a2389316249";let l=n},644206(e,a,t){var n;t.r(a),t.d(a,{default:()=>i});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useNormalizePinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:n=[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null};l.hash="830edb300e7c7867cd6df7ec2716d975";let i=l},898917(e,a,t){t.r(a),t.d(a,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useSamSegmentation_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};n.hash="50c726067ab8af873ed4afded90b7bed";let l=n},754150(e,a,t){t.r(a),t.d(a,{default:()=>k});var n,l=t(61163),i=t(859471),r=t(825193),s=t(979638),o=t(19821),d=t(450810),c=t(714364),u=t(48344),p=t(63661),g=t(538329),h=t(123576),m=t(718882),y=t(844255),f=t(385800),_=t(562615);let v=(void 0!==n||(n=t(727533)).hash&&"45cea1099e24f55ebce4abebdb411447"!==n.hash&&console.error("The definition of 'OneBar_oneBarModules' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function k({center:e=!1,hasProductFiltersApplied:a,hrefOverride:t,itemHeight:n=58,marginBottom:k=3,oneBarModulesKey:x,oneBarModulesRest:S,onFilterButtonClick:b,paddingBottom:w=12,paddingX:A=8,variant:F,viewParameter:P,viewType:I}){(0,i.useEffect)(()=>{(0,l.A)("OneBar","/app/common/react/components/OneBar/OneBar.tsx")},[]);let j=(0,i.useRef)(null),C=j.current?.firstElementChild?.firstElementChild?.firstElementChild,[T,R]=(0,i.useState)(0),[K,D]=(0,i.useState)(0),[E,L]=(0,i.useState)(!1),[M,z]=(0,i.useState)(!1),[$,B]=(0,i.useState)(0),O=(0,s.zy)(),N=(0,g.A)(),{isRTL:V}=(0,y._8)(),U=(0,i.useRef)(!1),W=new m.Ay,G=(0,r.useFragment)(v,x),H=G&&[G]||S,J=e&&(C?.clientWidth||0)>=(C?.scrollWidth||0);(0,i.useEffect)(()=>{let e=e=>{"Tab"===e.key&&(U.current=!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,i.useEffect)(()=>{R(0)},[O]),(0,i.useEffect)(()=>{D(C?.clientWidth||0);let e=(0,p.A)(()=>{D(C?.clientWidth||0)},100,{maxWait:200});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[C]),(0,i.useEffect)(()=>{let e=j.current;return e&&h.A.addObstruction("top",e),()=>{e&&h.A.removeObstruction("top",e)}}),(0,i.useEffect)(()=>{let e=C?.scrollWidth||0,a=0;for(let e=0;e<T;e+=1)a+=C?.children[e]?.offsetWidth||0;let t=e-a,n=K>=e;n&&R(0),L(T>0&&!n),z(t>K&&T<H.length&&!n),B(a)},[C,T,H.length,K,$,V]);let Y=()=>{T+3<H.length?R(T+3):R(H.length-1)},q=()=>{T-3>=0?R(T-3):R(0)},Q=(0,i.useRef)(null),{isFiltersDrawerFocused:X}=(0,c.M)()||{isFiltersDrawerFocused:!1},[Z,ee]=(0,i.useState)(X);return(0,i.useEffect)(()=>{!X&&Z&&Q.current?.focus(),ee(X)},[X,Z]),H.length>0&&(0,_.jsx)(f.e,{children:({hovered:e,onMouseEnter:l,onMouseLeave:i})=>(0,_.jsxs)(o.az,{ref:j,color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:w}},"data-root-margin":"search-one-bar","data-test-id":"scrollable-one-bar-root",marginBottom:k,onMouseEnter:l,onMouseLeave:i,position:"relative",children:[(0,_.jsx)(o.az,{dangerouslySetInlineStyle:{__style:{overflowX:"clip"}},paddingX:A,position:"relative",children:(0,_.jsx)(o.az,{dangerouslySetInlineStyle:{__style:{[V?"right":"left"]:`-${$}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,_.jsx)(o.so,{alignItems:"center",gap:{row:2,column:0},height:n,justifyContent:J?"center":void 0,children:H.map((e,n)=>(0,_.jsx)(o.az,{ref:1===n?Q:void 0,onFocus:()=>{U.current||R(n)},onMouseDown:()=>U.current=!0,tabIndex:1===n?-1:void 0,children:(0,_.jsx)(u.A,{hasProductFiltersApplied:a,hrefOverride:t,impressionsFramework:W,index:n,module:e,oneBarModulesKey:G??null,onFilterButtonClick:b,variant:F,viewParameter:P,viewType:I})},`OneBarModule-${e.entityId||e.id||""}`))})})}),e&&(0,_.jsxs)(o.az,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{background:(0,d.JB)(V,E,M),paddingBottom:12,paddingLeft:32,paddingRight:32,pointerEvents:"none"}},"data-test-id":"one-bar-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,_.jsx)(o.az,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:E&&(0,_.jsx)(o.K0,{accessibilityLabel:N.bt("Back", "Back", "oneBar.navArrow.back", undefined, true),bgColor:"default",icon:"chevron-left",onClick:q})}),(0,_.jsx)(o.az,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:M&&(0,_.jsx)(o.K0,{accessibilityLabel:N.bt("Forwards", "Forward", "oneBar.navArrow.forward", undefined, true),bgColor:"default",icon:"chevron-right",onClick:Y})})]})]})})}},659182(e,a,t){t.d(a,{A:()=>r});var n=t(601185),l=t(844255),i=t(971289);function r(){let{isAuthenticated:e}=(0,l._8)(),a=(0,i.M)(),{checkExperiment:t}=(0,n.A)();return{mWebCloseupRedesignEnabled:e&&a&&t("mweb_closeup_redesign").anyEnabled,mWebCloseupRedesignExpGroup:t("mweb_closeup_redesign").group}}},450810(e,a,t){t.d(a,{Gb:()=>i,JB:()=>n,Zr:()=>l});let n=(e,a,t)=>{let n=[];return(e&&a||!e&&t)&&n.push("linear-gradient(to left, var(--sema-color-background-default, #fff), transparent 40px)"),(e&&t||!e&&a)&&n.push("linear-gradient(to right, var(--sema-color-background-default, #fff), transparent 40px)"),n.join(",")},l={display:{backgroundColorHex:["#efefef","#292929"],selectedBackgroundColorHex:["#292929"],icon:3,textColorHex:["#111111","#ffffff"],selectedTextColorHex:["#ffffff"]},moduleType:0,id:""},i={moduleType:-1,id:""}},412909(e,a,t){t.d(a,{A:()=>l});var n=t(803489);function l(e,a,t){let l=(0,n.A)(e.search),i=parseFloat(l.x??""),r=parseFloat(l.y??""),s=parseFloat(l.w??""),o=parseFloat(l.h??"");if(function(...e){return e.every(e=>e>=0&&e<=1)}(i,r,s,o)&&a&&t)return{x:Math.floor(i*a),y:Math.floor(r*t),w:Math.floor(s*a),h:Math.floor(o*t)};{let e=parseInt(l.x??"",10),a=parseInt(l.y??"",10),t=parseInt(l.w??"",10),n=parseInt(l.h??"",10);return!function(...e){return e.every(Number.isInteger)}(e,a,t,n)?null:{x:e,y:a,w:t,h:n}}}},203168(e,a,t){t.d(a,{G:()=>y,A:()=>f});var n=t(61163),l=t(859471),i=t(19821),r=t(979638),s=t(586733),o=t(662449),d=t(538329),c=t(996209),u=t(562615);function p({arrowType:e,viewParameter:a,viewType:t}){(0,l.useEffect)(()=>{(0,n.A)("FlashlightBackButton","/app/common/react/components/discover/Flashlight/FlashlightBackButton.tsx")},[]);let p=(0,d.A)(),g=(0,r.Zp)(),h=(0,r.zy)(),{previous:m}=(0,o.qD)(),{logContextEvent:y}=(0,s.o)(),f=(0,c.A)(h.pathname);return(0,u.jsx)(i.az,{"data-test-id":"go-back-button",children:(0,u.jsx)(i.K0,{accessibilityLabel:p.bt("Go back", "Go back", "Accessible icon for close button", undefined, true),icon:e??"arrow-left",iconColor:"default",onClick:()=>{(y({event_type:101,view_type:t,element:34,view_parameter:a}),0===m.length)?g(f?`/pin/${f}/`:"/",{replace:!0}):g(-1)},size:"xl"})})}var g=t(386610),h=t(123576),m=t(510489);let y=64;function f({isProductPage:e,title:a,viewParameter:t,viewType:r}){(0,l.useEffect)(()=>{(0,n.A)("RelatedProductsHeader","/app/common/react/components/shopping/RelatedProducts/RelatedProductsHeader.tsx")},[]);let s=(0,l.useRef)(null);return(0,l.useEffect)(()=>(s.current&&h.A.addObstruction("top",s.current),()=>{s.current&&h.A.removeObstruction("top",s.current)})),(0,u.jsx)(m.A,{position:e?"sticky":"fixed",shouldShowShadow:!0,children:(0,u.jsxs)(i.az,{color:"default",display:"flex",height:y,marginBottom:4,children:[(0,u.jsx)(i.az,{marginStart:4,minWidth:y,children:(0,u.jsx)(p,{arrowType:a?"arrow-left":"close",viewParameter:t,viewType:r})}),(0,u.jsx)(i.az,{ref:s,alignItems:"center",color:"default","data-test-id":"related-products-header",display:"flex",flex:"grow",justifyContent:"center",children:(0,u.jsx)(g.A,{title:a})}),(0,u.jsx)(i.az,{marginEnd:4,minWidth:y})]})})}},684258(e,a,t){t.d(a,{A:()=>l,c:()=>n});let n=e=>"phone"===e?55:80;function l(e,a){return a?0:n(e)}},599256(e,a,t){t.d(a,{A:()=>i,c:()=>n.cq});var n=t(803415),l=t(844255);let i=({dateFormatType:e,useUTC:a=!0,value:t})=>{let i=(0,l._8)();return(0,n.Ay)(i.locale,t,e,a)}},766675(e,a,t){t.d(a,{A:()=>r});var n=t(859471);function l(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class i extends n.Component{constructor(...e){super(...e),l(this,"ref",(0,n.createRef)()),l(this,"observer",null),l(this,"handleVisibilityChanged",(e,a)=>{this.props.onVisibilityChange(e,a)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let r=i},853494(e,a,t){t.d(a,{XC:()=>i,Z9:()=>l,a0:()=>n});let n=e=>"ios"===e&&(window.devicePixelRatio||1)*window.screen.height==2436,l=e=>window.innerHeight>=748&&n(e),i=()=>!("u"<typeof window)&&!!window.navigator&&(/iPad/.test(navigator.platform)||"MacIntel"===navigator.platform&&"ontouchend"in document&&Math.min(window.screen.width,window.screen.height)>=700)},214429(e,a,t){t.r(a),t.d(a,{default:()=>c});var n=t(61163),l=t(859471),i=t(19821),r=t(853494),s=t(264124),o=t(844255),d=t(562615);let c=({children:e,dataLayoutShiftBoundaryId:a,hasFixedHeader:t=!1,hasGutter:c=!0,height:u,showKeychainError:p=!1,useViewport:g=!1})=>{(0,l.useEffect)(()=>{(0,n.A)("MobilePageContainer","/app/packages/layout/MobilePageContainer.tsx")},[]);let h=(0,o._8)(),m=28*!!(0,r.Z9)(h.userAgent.platform);return(0,d.jsx)(i.az,{"data-layout-shift-boundary-id":a||"PageContainer",height:g?`calc(100vh - ${m}px)`:u,paddingX:c?2:void 0,paddingY:t||p?void 0:3,children:(0,d.jsx)(s.k,{value:!!c,children:e})})}},620067(e,a,t){t.d(a,{d:()=>n});function n(e,a,t){return!!(e&&e.trim().length>0&&a&&!t)}},352397(e,a,t){t.d(a,{A:()=>s}),t(825193);var n,l=t(535273),i=t(538329);let r=(void 0!==n||(n=t(644206)).hash&&"830edb300e7c7867cd6df7ec2716d975"!==n.hash&&console.error("The definition of 'useNormalizePinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),s=e=>{let a,t=(0,i.A)(),n=(0,l.A)(r,e),s=n.trackedLink||n.link||n.images_orig&&n.images_orig.url,{richMetadata:o,richSummary:d}=n,c=t.bt("Saved from ", "Saved from ", "Closeup pin annotation", undefined, true);return o&&o.products&&o.products[0]&&o&&o.products[0].name&&o.products[0].offerSummary&&(c=t.bt("Product sold by ", "Product sold by ", "pin annotation", undefined, true),a=(o.products?.[0]||void 0)?.offerSummary),!a&&d&&d&&d.products&&d.products[0]&&d&&d.products[0].name&&d.products[0].offerSummary&&(c=t.bt("Product sold by ", "Product sold by ", "pin annotation", undefined, true)),{pinLink:s,pinCreditPrefix:c,pinTitle:n.closeupUnifiedTitle,pinDescription:n.closeupUnifiedDescription,pinCategory:n.category}}},364107(e,a,t){t.d(a,{A:()=>n});function n(e,a,t,l=0){if(-1===a||-1===t||a===t)return e;let i=t+l,r=a+l;if(i<0||i>=e.length||r<0||r>=e.length)return e;let s=[...e],o=s[r],d=r<i?1:-1;for(let a=r;a!==i;a+=d)s[a]=e[a+d];return s[i]=o,s}},319571(e,a,t){t.d(a,{A:()=>_});var n=t(61163),l=t(859471),i=t(19821),r=t(662449),s=t(766675),o=t(844255),d=t(274638),c=t(284300),u=t(697294),p=t(809799),g=t(699613),h=t(562615);function m(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class y extends l.Component{constructor(e){super(e),m(this,"componentWillUnmount",()=>{this.unregisterComponent()}),m(this,"getContext",()=>{let{clientTrackingParams:e,component:a,element:t,objectId:n,timeSpentContext:l,view:i,viewParameter:r}=this.props;return{view:i||l?.view,viewParameter:r||l?.viewParameter,component:a||l?.component,element:t,objectId:n||l?.objectId,clientTrackingParams:e||l?.clientTrackingParams,getParentUuid:()=>this.getUuid(),getGrandparentUuid:()=>this.getParentId()}}),m(this,"getLoggerContext",()=>{let e={...this.getContext()};return delete e.getParentUuid,e}),m(this,"getParentId",()=>{let{timeSpentContext:e,shouldUseGrandparentId:a=!1}=this.props;if(a&&e&&e.getGrandparentUuid){let a=e.getGrandparentUuid();if(a)return a}return e?.getParentUuid?.()}),m(this,"getUuid",()=>this.state.timedPair?this.state.timedPair.uuid:void 0),m(this,"getTimedPair",()=>this.state.timedPair),m(this,"setTimedPair",(e,a)=>{this.setState({timedPair:e},()=>{a&&a()})}),m(this,"isRegistered",!1),m(this,"registerComponent",()=>{this.props.timeSpentManager.registerComponent(this),this.isRegistered=!0}),m(this,"unregisterComponent",()=>{this.isRegistered&&(this.props.timeSpentManager.unregisterComponent(this),this.isRegistered=!1)}),m(this,"handleVisibilityChange",e=>{let{intersectionRatio:a}=e[0],{bottom:t,left:n,right:l,top:i}=e[0].intersectionRect;a>0?this.registerComponent():0===a&&(0===t&&0===n&&0===l&&0===i?this.unregisterComponent():this.registerComponent())}),this.state={timedPair:new u.A(this.getLoggerContext())}}componentDidUpdate(e){!this.isRegistered||e.view===this.props.view&&e.viewParameter===this.props.viewParameter&&e.component===this.props.component&&e.element===this.props.element&&e.objectId===this.props.objectId&&(0,d.A)(e.auxData,this.props.auxData)&&(0,d.A)(e.viewData,this.props.viewData)||(this.unregisterComponent(),setTimeout(this.registerComponent))}render(){let{children:e,intersectionObserverBoxHeight:a}=this.props;return(0,h.jsx)(p.I,{value:this.getContext(),children:(0,h.jsx)(s.A,{onVisibilityChange:this.handleVisibilityChange,options:{threshold:0},children:t=>(0,h.jsx)(i.az,{ref:t,height:a??"100%",children:l.Children.only(e)})})})}componentDidMount(){(0,n.A)("DeprecatedTimeSpent","/app/packages/time-spent/DeprecatedTimeSpent.tsx")}}function f(e){let a=(0,r.qD)(),t=(0,p.J)(),n=(0,c.A)(),i=(0,g.Vk)(),{requestIdentifier:s=""}=(0,o._8)(),d={app_instance_id:s.slice(0,8),...e.auxData??{}};return(0,l.useEffect)(()=>{n?.setHistoryStackContext(a)},[a,n]),(0,l.useEffect)(()=>{n?.setPins(i??{})},[i,n]),n?(0,h.jsx)(y,{...e,auxData:d,timeSpentContext:t,timeSpentManager:n,children:e.children}):e.children}f.displayName="DeprecatedTimeSpent";let _=f},809799(e,a,t){t.d(a,{I:()=>n,J:()=>l});let{Provider:n,getMaybe:l}=(0,t(987628).A)("timeSpentContext")},284300(e,a,t){t.d(a,{A:()=>i,q:()=>n});let{Provider:n,getMaybe:l}=(0,t(987628).A)("TimeSpentManagerContext"),i=l},710278(e,a,t){t.d(a,{A:()=>n});function n({cropArea:e,scaledWidth:a,scaledHeight:t}){return{h:Math.floor((e.h||0)*t),w:Math.floor((e.w||0)*a),x:Math.floor((e.x||0)*a),y:Math.floor((e.y||0)*t)}}},542758(e,a,t){t.d(a,{A:()=>n});function n(e){return{h:e?.h??void 0,is_stela:e?.isStela??void 0,labelId:e?.labelId??void 0,label_x:e?.labelX??void 0,label_y:e?.labelY??void 0,label:e?.label??void 0,max_annotation_num_documents:e?.maxAnnotationNumDocuments??void 0,score:e?.score??void 0,show_on_closeup:e?.showOnCloseup??void 0,title:e?.title??void 0,w:e?.w??void 0,x:e?.x??void 0,y:e?.y??void 0}}},946013(e,a,t){t.r(a),t.d(a,{default:()=>b});var n=t(61163),l=t(859471),i=t(979638),r=t(19821),s=t(586733),o=t(131094),d=t(803489),c=t(710278),u=t(566771),p=t(931509),g=t(168079),h=t(601185),m=t(801296),y=t(562615);let f=Math.ceil(40),_=f+1;function v({isHidden:e,isObjectLevelCrop:a,isSelected:t,maskHeight:i,maskId:s,maskUrl:d,maskWidth:c,maskX:u,maskY:g}){let v;(0,l.useEffect)(()=>{(0,n.A)("CutoutGlow","/app/www/Cutouts/CutoutGlow.tsx")},[]);let{checkExperiment:k}=(0,h.A)(),{insetIntensity:x,debugMode:S,showHiddenCutoutsinDebug:b}={insetIntensity:""===(v=k("web_cutout_glow_inset").group.split("_"))[0]||Number.isNaN(Number(v[0]))?void 0:Number(v[0]),debugMode:v.includes("debug"),showHiddenCutoutsinDebug:v.includes("all")},w=`glow-sweep-${s}`,A=Math.round(.35*i),F=i/2+A/2,P=a?.25:.5,{svgElement:I,maskStyle:j}=(0,m.A)({debugMode:S,insetIntensity:x,kind:"glow",maskHeight:i,maskId:s,maskUrl:d,maskWidth:c});return(0,y.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{left:u,top:g,...j,visibility:t?"hidden":"visible"}},"data-test-id":"cutout-item",height:i,id:p.J4,position:"absolute",width:c,children:(!e||b)&&(0,y.jsxs)(l.Fragment,{children:[I,(0,y.jsx)(o.A,{unsafeCSS:`
          @keyframes ${w} {
            0%                    { mask-position: 0 -${F}px; opacity: ${P}; }
            ${f}% { mask-position: 0  ${F}px; opacity: ${P}; }
            ${_}%      { mask-position: 0  ${F}px; opacity: 0; }
            100%                  { mask-position: 0 -${F}px; opacity: 0; }
          }`}),(0,y.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none",animation:`${w} 5s linear infinite`,animationDelay:"1s",maskImage:`
              radial-gradient(
                ellipse ${4*A}px ${A}px at center,
                white 0%,
                white 15%,
                rgba(255, 255, 255, 0.9) 30%,
                rgba(255, 255, 255, 0.7) 45%,
                rgba(255, 255, 255, 0.5) 55%,
                rgba(255, 255, 255, 0.3) 65%,
                rgba(255, 255, 255, 0.15) 72%,
                rgba(255, 255, 255, 0.06) 80%,
                rgba(255, 255, 255, 0.01) 90%,
                transparent 100%
              )`,maskPosition:`0 -${F}px`,maskSize:"100% 100%",maskRepeat:"no-repeat"}},"data-test-id":"cutout-glow-oval",height:"100%",opacity:0,width:"100%",children:(0,y.jsx)(r._V,{alt:"cutout-glow-background-image",color:"white",fetchPriority:"high",fit:"cover",loading:"eager",naturalHeight:i,naturalWidth:c,role:"presentation",src:a?void 0:"https://s.pinimg.com/webapp/cutout-glow-background-7b325b4f.jpg"})})]})})}var k=t(243126);function x({isHovered:e,isObjectLevelCrop:a,isPinLevelCrop:t,isSelected:i,mask:r,pinId:o,pinImageHeight:d,pinImageUrl:c,pinImageWidth:u,viewParameter:p,viewType:h}){(0,l.useEffect)(()=>{(0,n.A)("CutoutObject","/app/www/Cutouts/CutoutObject.tsx")},[]);let{logContextEvent:m}=(0,s.o)(),{id:f,isHidden:_,maskHeight:x,maskUrl:S,maskWidth:b,maskX:w,maskY:A}=r;return(0,g.A)(()=>{_||m({aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})},event_type:120,element:14154,view_parameter:p,view_type:h,...o&&{object_id_str:o}})}),(0,y.jsxs)(l.Fragment,{children:[(0,y.jsx)(k.A,{imageHeight:d,imageUrl:c,imageWidth:u,isHovered:e,isPinLevelCrop:t,isSelected:i,maskHeight:x,maskId:f,maskUrl:S,maskWidth:b,maskX:w,maskY:A}),(0,y.jsx)(v,{isHidden:_,isObjectLevelCrop:a,isSelected:i,maskHeight:x,maskId:f,maskUrl:S,maskWidth:b,maskX:w,maskY:A})]})}var S=t(676791);function b({bitmapMasks:e,entrypoint:a,hoveredCutoutIndex:t,imageContainerX:g,imageContainerY:m,onCropperUpdate:f,pinId:_,pinImageHeight:v,pinImageUrl:k,pinImageWidth:b,selectedCutoutIndex:w,setHoveredCutoutIndex:A,setSelectedCutoutIndex:F,trafficSource:P,viewParameter:I,viewType:j}){(0,l.useEffect)(()=>{(0,n.A)("CutoutObjects","/app/www/Cutouts/CutoutObjects.tsx")},[]);let{logContextEvent:C}=(0,s.o)(),T=(0,i.zy)(),R=(0,i.Zp)(),K=(0,l.useRef)(null),[D,E]=(0,l.useState)(!1),{w:L,h:M,cropSource:z}=(0,d.A)(T.search),$=(0,l.useMemo)(()=>Number(L)===b&&Number(M)===v||void 0===L&&void 0===M,[M,v,b,L]),B=(0,l.useMemo)(()=>9===Number(z),[z]),{cutoutContexts:O,maskData:N}=function(e,a,t){let[n,i]=(0,l.useState)([]),[r,s]=(0,l.useState)([]),[o,d]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let{maskData:n,urls:l}=e.reduce((e,n)=>{let l=(0,S.gy)(n,a,t);return l&&(e.maskData.push(l.maskData),e.urls.push(l.maskUrl)),e},{maskData:[],urls:[]});if(s(n),0===n.length)return i([]),d(!1),()=>l.forEach(e=>URL.revokeObjectURL(e));let r=!1;return d(!0),(async()=>{let e=n.map(async e=>{let a=document.createElement("canvas"),t=a.getContext("2d",{willReadFrequently:!0});if(!t)return null;let{maskWidth:n,maskHeight:l}=e;a.width=n,a.height=l;try{let a=new Image;return a.crossOrigin="anonymous",new Promise(i=>{a.onload=()=>{r?i(null):(t.drawImage(a,0,0,n,l),i(t))},a.onerror=()=>i(null),a.src=e.maskUrl})}catch{return null}}),a=await Promise.all(e);r||(i(a),d(!1))})(),()=>{r=!0,l.forEach(e=>URL.revokeObjectURL(e))}},[e,a,t]),{cutoutContexts:n,maskData:r,isLoading:o}}(e,b,v),V=function({cutoutContexts:e,imageContainerX:a,imageContainerY:t,maskData:n,pinId:i,setHoveredCutoutIndex:r,viewParameter:o,viewType:d}){let{logContextEvent:c}=(0,s.o)(),{checkExperiment:u}=(0,h.A)(),{anyEnabled:p,group:g}=u("web_cutout_hit_detection_cache"),m="control"===g?1:"employees"===g?5:Number(g.split("_")[1]||5),y=(0,l.useRef)(new Map);(0,l.useEffect)(()=>{y.current.clear()},[n]);let f=(0,l.useCallback)((e,a)=>{e!==a&&(r(e),null!==e&&c({event_type:105,element:14154,view_parameter:o,view_type:d,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})},...i&&{object_id_str:i}}))},[i,r,c,o,d]);return(0,l.useCallback)((l,i,r)=>{let s=p?`${Math.round(l.clientX/m)*m},${Math.round(l.clientY/m)*m}`:"";if(p&&y.current.has(s))return void f(y.current.get(s)??null,i);let o=l.clientX-a,d=l.clientY-t;for(let a=n.length-1;a>=0;a-=1){let t=n[a],l=e[a];if(!l||!t||a===r||!(0,S.LG)(o,d,t))continue;let c=o-t.maskX,u=d-t.maskY;if((0,S.wq)(l,c,u)){p&&y.current.set(s,a),f(a,i);return}}p&&y.current.set(s,null),f(null,i)},[p,e,a,t,n,m,f])}({cutoutContexts:O,imageContainerX:g,imageContainerY:m,maskData:N,pinId:_,setHoveredCutoutIndex:A,viewParameter:I,viewType:j}),U=(0,l.useCallback)(()=>E(!1),[]),W=(0,l.useCallback)(e=>{(e.movementX||e.movementY)&&E(!0),0===e.buttons?V(e,t,w):A?.(null)},[V,t,w,A]),G=(0,l.useCallback)(e=>V(e,t,w),[V,t,w]),H=(0,l.useCallback)(()=>A(null),[A]),J=(0,l.useCallback)(()=>{if(D||null===t)return void E(!1);if(A(null),F?.(t),!N[t])return;let{maskXRatio:e,maskYRatio:n,maskWidthRatio:l,maskHeightRatio:i}=N[t],r=(0,c.A)({cropArea:{x:e,y:n,w:l,h:i},scaledWidth:b,scaledHeight:v});if(f)f({cropArea:r,cropSource:9}),C({element:14154,event_type:101,view_parameter:I,view_type:j,..._&&{object_id_str:_}});else{let e=(0,u.A)({cropArea:r,cropSource:9,entrypoint:a,trafficSource:P});window.location.search!==e&&(C({aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})},element:14154,event_type:101,view_parameter:I,view_type:j,..._&&{object_id_str:_}}),R(`${window.location.pathname}${e}`,{replace:!0}))}},[D,t,A,F,N,b,v,f,C,I,j,_,a,P,R]);return(0,l.useEffect)(()=>{let e=K.current;if(e)return e.addEventListener("mousedown",U),e.addEventListener("mousemove",W),e.addEventListener("mouseup",G),e.addEventListener("mouseleave",H),e.addEventListener("click",J),()=>{e.removeEventListener("mousedown",U),e.removeEventListener("mousemove",W),e.removeEventListener("mouseup",G),e.removeEventListener("mouseleave",H),e.removeEventListener("click",J)}},[U,W,G,H,J]),(0,y.jsxs)(r.az,{ref:K,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof t?"pointer":"auto"}},"data-bitmaps-ready":N.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,y.jsx)(o.A,{unsafeCSS:p.PI}),N.map((e,a)=>(0,y.jsx)(x,{isHovered:t===a,isObjectLevelCrop:B,isPinLevelCrop:$,isSelected:w===a,mask:e,pinId:_,pinImageHeight:v,pinImageUrl:k,pinImageWidth:b,viewParameter:I,viewType:j},e.id))]})}},243126(e,a,t){t.d(a,{A:()=>c});var n=t(61163),l=t(859471),i=t(610355),r=t(19821),s=t(931509),o=t(801296),d=t(562615);function c({imageHeight:e,imageUrl:a,imageWidth:t,isHovered:c,isPinLevelCrop:u,isSelected:p,maskHeight:g,maskId:h,maskUrl:m,maskWidth:y,maskX:f,maskY:_}){(0,l.useEffect)(()=>{(0,n.A)("CutoutOverlay","/app/www/Cutouts/CutoutOverlay.tsx")},[]);let v=(0,l.useRef)(null),k=c||p,x=u&&c?1.2:1,{svgElement:S,maskStyle:b}=(0,o.A)({maskUrl:m,maskWidth:y,maskHeight:g,maskId:h,kind:"overlay"});return(0,d.jsx)(i.A,{appear:p,classNames:s.CI,in:k,nodeRef:v,timeout:{appear:2e3,enter:300,exit:300},children:(0,d.jsxs)(r.az,{ref:v,dangerouslySetInlineStyle:{__style:{left:f,top:_,...b,pointerEvents:"none",filter:`brightness(${x})`}},height:g,opacity:0,overflow:"hidden",position:"absolute",width:y,children:[S,(0,d.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{left:-f,top:-_}},height:e,position:"absolute",width:t,children:(0,d.jsx)(r._V,{alt:"cutout-overlay-image",color:"transparent",fit:"cover",naturalHeight:e,naturalWidth:t,src:a})})]})})}},801296(e,a,t){t.d(a,{A:()=>l});var n=t(562615);function l({blurIntensity:e=.1,debugMode:a=!1,insetIntensity:t=2,kind:l,maskHeight:i,maskId:r,maskUrl:s,maskWidth:o,maxBlurLength:d=100}){let c=`${l}-${r}`,u=`insetBlurFilter-${c}`,p=`originalMask-${c}`,g=`featheredMask-${c}`,h=Math.min(d,Math.round(Math.min(o,i)))*e;return{svgElement:(0,n.jsxs)("svg",{"data-gestalt-valid-html":"Image",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:[(0,n.jsxs)("defs",{children:[(0,n.jsxs)("filter",{id:u,children:[(0,n.jsx)("feGaussianBlur",{edgeMode:"none",stdDeviation:h}),(0,n.jsx)("feComponentTransfer",{children:(0,n.jsx)("feFuncA",{amplitude:"1",exponent:t,offset:"0",type:"gamma"})})]}),(0,n.jsx)("mask",{id:p,children:(0,n.jsx)("image",{height:i,href:s,id:`${p}-image`,width:o})}),(0,n.jsx)("use",{href:`#${p}-image`,id:`${p}-white`,mask:`url(#${p})`}),(0,n.jsx)("mask",{id:g,children:(0,n.jsx)("use",{filter:`url(#${u})`,href:`#${p}-white`,mask:`url(#${p})`})})]}),a&&(0,n.jsx)("rect",{fill:"green",height:i,mask:`url(#${g})`,width:o,x:"0",y:"0"})]}),maskStyle:{mask:`url(#${g})`}}}},180154(e,a,t){t.d(a,{A:()=>p});var n,l=t(859471);t(825193);var i=t(417978);async function r({imageBlob:e,boundingBox:a}){let t=new FormData;t.append("image",e),a&&t.append("bounding_box",a);let{promise:n}=(0,i.A)({url:"/camera-sam-segmentation/",type:"PUT",data:t}),l=await n,{data:r}=(await l.json()).responsePayload.resourceResponse;return r}var s=t(535273),o=t(430705),d=t(627012);let c=(void 0!==n||(n=t(898917)).hash&&"50c726067ab8af873ed4afded90b7bed"!==n.hash&&console.error("The definition of 'useSamSegmentation_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),u=e=>JSON.stringify({x:Math.min(Math.max(e.x||0,0),1),y:Math.min(Math.max(e.y||0,0),1),width:Math.min(Math.max(e.w||1,0),1),height:Math.min(Math.max(e.h||1,0),1)});function p({pinKey:e,isVisualSearch:a=!1,boundingBox:t,imageBlob:n,isCollage:i=!1,isCustomImage:p=!1}){let g=(0,s.A)(c,e),h=(0,d.A)(),m=(0,l.useMemo)(()=>({client:"visual_cutout",cleanup_masks:!0,...t&&{bounding_box:u(t),use_gss:!1,write_to_galaxy:!1}}),[t]),{data:y}=(0,o.A)(g&&g.entityId?{name:"ApiResource",options:{url:`/v3/pins/${g.entityId}/segmentation/sam/`,data:{...a&&h,...i&&m}}}:null),f=function({imageBlob:e,isCustomImage:a=!1,boundingBox:t}){let[n,i]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let n=async()=>{a&&e&&i(await r({imageBlob:e,boundingBox:t}))};i(null),n()},[a,e,t]),n}({imageBlob:n,isCustomImage:p,boundingBox:t?u(t):void 0});return p?f:y}},360320(e,a,t){t.d(a,{A:()=>v,v:()=>_});var n=t(61163),l=t(859471),i=t(19821),r=t(210909),s=t(411805),o=t(538678),d=t(485321),c=t(971289),u=t(168079),p=t(780355),g=t(515568),h=t(47818),m=t(160587),y=t(411812),f=t(562615);let _=25;function v({align:e,customLayoutType:a,getColumnSpanConfig:t,getResponsiveModuleConfigForSecondItem:_,emptyState:v,feedItems:k,feedKey:x,maxColumns:S,minColumns:b,pagination:{hasNext:w,isLoadingNext:A,loadNext:F,refetch:P},pullToRefresh:I,renderFeedItem:j,serverRender:C,isLoadingStateEnabled:T,isLoadingAccessibilityLabel:R,isLoadedAccessibilityLabel:K,layout:D,forceShowLoadingState:E}){(0,l.useEffect)(()=>{(0,n.A)("SimpleFeed","/app/www/SimpleFeed.tsx")},[]);let L=(0,c.qJ)(),{experimentalColumnWidth:M,experimentalGutter:z}=(0,s.A)(),[$,B]=(0,l.useState)(!1),O=1===S?window.innerWidth:void 0,N="userSearch"===a?window.innerWidth-16:200,V=A&&0===k.length&&!$&&!T,U="desktopFlashlight"===a||"ideaPage"===a&&L?-2:-1,W=b??2;return"userSearch"===a&&(W=1),(0,u.A)(()=>(window.addEventListener("online",F),()=>window.removeEventListener("online",F))),(0,f.jsxs)(i.az,{"data-test-id":"MobileFeed",children:[(0,f.jsx)(g.A,{enabled:!!I,onPull:()=>{P(),B(!0)},refreshing:$}),(0,f.jsxs)(i.az,{"data-test-id":"grid",marginEnd:U,marginStart:U,opacity:$?50:100,children:[(0,f.jsx)(o.A,{isAtEndOfFeed:!w,isPlaceholderGrid:T&&A&&!k.length,itemCount:k.length,children:k.length?(0,f.jsx)(i.az,{"data-test-id":"feed",marginTop:(0,p.xf)({isDesktop:L}),children:(0,f.jsx)(d.A.Consumer,{children:n=>(0,f.jsx)(l.Fragment,{children:(0,f.jsx)(y.A,{children:(0,f.jsx)(r.default,{_getResponsiveModuleConfigForSecondItem:_,align:e||("ideaPage"===a?"start":void 0),cacheKey:x,columnWidth:L?M??236:O??N,getColumnSpanConfig:t,gutterWidth:L?z??16:void 0,id:C?x:void 0,isFetching:E??A,isLoadedAccessibilityLabel:K??"",isLoadingAccessibilityLabel:R??"",isLoadingStateEnabled:E??!!T,items:k,layout:D??void 0,loadItems:F,maxColumns:S,minCols:W,optOutFluidGridExperiment:null!=S,renderItem:({data:e,itemIdx:a})=>j(e,a),scrollContainerRef:n,serverRender:C})})})})}):A?(0,f.jsx)(h.A,{}):v??null}),V&&(0,f.jsx)(i.az,{column:12,paddingY:2,children:(0,f.jsx)(m.A,{partialViewportWidth:"desktopFlashlight"===a})})]})]})}},695342(e,a,t){t.d(a,{A:()=>eZ});var n,l,i,r,s,o,d,c,u=t(61163),p=t(859471);t(825193);var g=t(979638),h=t(19821),m=t(535273),y=t(219053),f=t(538329),_=t(430705),v=t(337492),k=t(412909),x=t(562615);function S({isTopRow:e,image:a}){return(0,p.useEffect)(()=>{(0,u.A)("ShoppingUpsellStoryCardDetail","/app/common/react/components/shopping/ShoppingUpsellStoryCardDetail.tsx")},[]),(0,x.jsxs)(h.n1,{height:e?217:168,wash:!0,width:e?236:117,children:[a.url&&(0,x.jsx)(h._V,{alt:a.alt||"",fit:"cover",naturalHeight:a.height??1,naturalWidth:a.width??1,src:a.url}),!!a.price&&(0,x.jsx)(h.az,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"18px",color:"#111",fontSize:"10px",fontWeight:"600",lineHeight:"24px",padding:"06px"}},"data-test-id":"shopping-upsell-price",height:24,left:!0,margin:1,paddingX:2,paddingY:1,position:"absolute",top:!0,children:a.price})]})}var b=t(586733),w=t(989457),A=t(726329),F=t(386379),P=t(459951),I=t(831707);let j={borderRadius:"16px 16px 25px 25px",WebkitMaskImage:"-webkit-radial-gradient(white, black)"},C={marginBottom:"2px"},T={backgroundColor:"rgba(0, 0, 0, .1)"},R=({images:e,firstImageIndex:a})=>{let t=a+1,n=a+2;return(0,x.jsxs)(h.az,{overflow:"hidden",rounding:400,children:[(0,x.jsx)(h.az,{dangerouslySetInlineStyle:{__style:C},children:e.at(a)?(0,x.jsx)(S,{image:e[a],isTopRow:!0}):null}),e.length>n?(0,x.jsxs)(h.so,{alignItems:"stretch",justifyContent:"between",children:[(0,x.jsx)(S,{image:e[t]}),(0,x.jsx)(S,{image:e[n]})]}):null]})};function K({dangerouslySetActionUrl:e,query:a,story:t,slotIndex:n}){let l,i,r,s,o;(0,p.useEffect)(()=>{(0,u.A)("ShoppingUpsellStoryCard","/app/common/react/components/shopping/ShoppingUpsellStoryCard.tsx")},[]);let{logContextEvent:d}=(0,b.o)(),{action:c,id:g,objects:m,story_type:y,subtitle:f}=t,{text:_,url:v}=c||{},[k,S]=(0,p.useState)(!1),C=(0,p.useCallback)(()=>S(!0),[S]),K=(0,p.useCallback)(()=>S(!1),[S]),D=(m||[]).reduce((e,a)=>"pin"!==a.type?e:[...e,{domain:a.domain,image:{alt:a.title||a.description,height:a.images?.["474x"]?.height,url:a.images?.["474x"]?.url,width:a.images?.["474x"]?.width,price:(a.rich_summary?.products?.[0]||{}).offer_summary?.price}}],[]),E=(D[0]||{}).domain||void 0;["search_product_collage_story","shop_article_story"].includes(y||"")?(l=2,i=43,r={story_id:g,story_type:y,entered_query:a}):"shop_brand_story"===y||"shop_brand_affinity_story"===y?(l=1,i=92,E&&(r={story_type:y,commerce_data:JSON.stringify({domain:E})})):["stela_in_flashlight_card","stela_in_flashlight_onecol"].includes(y||"")?(l=72,i=3050):"related_domain_collage"===y?(l=72,i=3455):"related_products_collage"===y&&(l=1,i=3177);let L=()=>d({event_type:101,element:372,component:200,view_type:l,view_parameter:i,aux_data:{story_type:y}}),M=f?4:2;if(["related_domain_collage","shop_brand_story","shop_brand_affinity_story"].includes(y||"")&&c){let e=c.user;s=e&&(e.image_medium_url||e.image_large_url),o=e&&e.full_name}let z=e||v;if(!z)return null;let $=(0,F.A)({url:z})?"nofollow":"none";return(0,x.jsx)(A.g$,{componentType:200,contextLogData:r||{},impressionType:"Story",loggingId:y,slotIndex:n,viewParameter:i,viewType:l,children:({impressionTrackerRef:e})=>(0,x.jsx)(h.az,{ref:e,children:(0,x.jsx)(h.$A,{href:z,onTap:L,rel:$,children:(0,x.jsxs)(h.az,{dangerouslySetInlineStyle:{__style:j},onMouseEnter:C,onMouseLeave:K,overflow:"hidden",position:"relative",children:[(0,x.jsx)(R,{firstImageIndex:+!!["related_domain_collage","related_products_collage"].includes(y||""),images:D.map(({image:e})=>e)}),(0,x.jsx)(h.az,{alignItems:"center",color:"secondary",display:"flex",justifyContent:"center",marginTop:2,paddingX:3,paddingY:M,rounding:"pill",children:(0,x.jsxs)(h.az,{alignContent:"start",direction:"column",display:"flex",justifyContent:"center",margin:2,children:[f?(0,x.jsx)(h.az,{marginBottom:1,children:(0,x.jsx)(h.KJ,{align:"start",color:"subtle",children:f.format})}):null,(0,x.jsx)(h.KJ,{align:"start",weight:"bold",children:_})]})}),o&&s&&(0,x.jsx)(h.az,{margin:2,position:"absolute",right:!0,top:!0,children:(0,x.jsx)(w.eu,{name:o,outline:!0,size:"md",src:s})}),(0,x.jsx)(P.A,{visibility:k?"visible":"none",children:(0,x.jsx)(I.A,{additionalStyles:T})})]})})})})}var D=t(542975),E=t(752159);let L=(void 0!==n||(n=t(319869)).hash&&"610a35d46510240eb58e262c1909310c"!==n.hash&&console.error("The definition of 'BestPinCardAttribution_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),M=()=>{(0,E.uq)("click_best_pin_board",!0)},z=()=>{(0,E.uq)("click_best_pin_profile",!0)},$=({pin:e})=>{let{pinner:a}=e,{username:t,fullName:n}=a??{},l=a?.imageMediumUrl||a?.imageSmallUrl,i=`/${t??""}/`;return(0,x.jsx)(h.$A,{fullWidth:!1,href:i,onTap:z,rounding:"circle",children:(0,x.jsx)(w.eu,{name:n??"",outline:!0,size:"sm",src:l??""})})},B=({pin:e})=>{let a=(0,f.A)(),{board:t,pinner:n}=e,{name:l,privacy:i,url:r}=t??{},s=t?.entityId||"",{username:o,fullName:d}=n??{},c=`/${o??""}/`,u=(0,x.jsx)(h.KJ,{inline:!0,size:"200",weight:"bold",children:(0,x.jsx)(h.N_,{display:"inlineBlock",href:c,onClick:z,underline:"hover",children:d})},d);return"protected"===i?(0,D.vQ)(a.bt("{{ pinnerName }} saved this Pin", "{{ pinnerName }} saved this Pin", "Showing who saved this pin, but not which board (private board), on closeup", undefined, true),{pinnerName:u}):(0,D.vQ)(a.bt("{{ pinnerName }} saved to {{ boardName }}", "{{ pinnerName }} saved to {{ boardName }}", "Showing who saved this pin to which board on closeup", undefined, true),{pinnerName:u,boardName:(0,x.jsx)(h.KJ,{inline:!0,size:"200",weight:"bold",children:(0,x.jsx)(h.N_,{href:r??"",onClick:M,children:l},"board")},s)})},O=({pinKey:e})=>{(0,p.useEffect)(()=>{(0,u.A)("BestPinCardAttribution","/app/packages/BestPinCard/BestPinCardAttribution.tsx")},[]);let a=(0,m.A)(L,e);return(0,x.jsxs)(h.az,{alignItems:"center","data-test-id":"pin-attribution",direction:"row",display:"flex",marginTop:3,children:[(0,x.jsx)($,{pin:a}),(0,x.jsx)(h.az,{marginEnd:2}),(0,x.jsx)(h.KJ,{size:"200",children:(0,x.jsx)(B,{pin:a})})]})},N=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="underline")},V=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="none")};var U=t(743372);function W({pageType:e,pinCreditPrefix:a,pin:t,pinLink:n,viewParameter:l}){(0,p.useEffect)(()=>{(0,u.A)("BestPinCardClickthroughLink","/app/packages/BestPinCard/BestPinCardClickthroughLink.tsx")},[]);let i=(0,f.A)(),r=(0,U.A)();if("topic"!==e.page&&(!t.domain||"Uploaded by user"===t.domain))return null;let s="topic"!==e.page||e.isAuth?"100":"200",o="topic"===e.page&&!!t.nativeCreator,d=o?t.nativeCreator?.fullName:t.domain;return(0,x.jsx)(h.az,{display:"flex",flex:"none",justifyContent:"start",marginBottom:2,children:(0,x.jsx)(h.N_,{display:"inlineBlock",href:o?`/${t.nativeCreator?.username||""}/`:n,onClick:()=>{"topic"===e.page?(0,E.uq)("click_topic_best_pin_link"):r({event_type:12,view_type:3,object_id_str:t.entityId,component:85,view_parameter:l})},rel:"nofollow",target:"blank",underline:"hover",children:(0,x.jsx)(h.KJ,{size:s,children:(0,D.vQ)(i.bt("{{ pinCreditPrefix }} {{ pinCredit }}", "{{ pinCreditPrefix }} {{ pinCredit }}", "Tells the user where the pin is from in the form of \"Saved from <website>\"", undefined, true),{pinCreditPrefix:a,pinCredit:(0,x.jsx)(h.KJ,{inline:!0,size:s,weight:"bold",children:"topic"!==e.page?(0,x.jsxs)("span",{"data-gestalt-valid-html":"Text",onBlur:V,onFocus:N,onMouseLeave:V,onMouseOver:N,children:[" ",t.domain]}):d},o?"creatorProfile":"pinLinkDomain")})})})})}var G=t(599256),H=t(101295),J=t(620067),Y=t(132984),q=t(352397),Q=t(924257),X=t(539855),Z=t(413084),ee=t(164221);let ea=(void 0!==l||(l=t(306281)).hash&&"12f77507a9fdec344b44b7e659fa5ac1"!==l.hash&&console.error("The definition of 'RecipeMetadata_recipe' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function et({recipeKey:e}){(0,p.useEffect)(()=>{(0,u.A)("RecipeMetadata","/app/packages/recipePin/RecipeMetadata.tsx")},[]);let a=(0,m.A)(ea,e);if(a?.aggregateRating?.ratingValue&&a.aggregateRating.reviewCount){let e="number"==typeof a.cookTimes?.cook?.m&&"number"==typeof a.cookTimes.prep?.m?`${a.cookTimes.cook.m+a.cookTimes.prep.m} minutes \xb7 `:"";return(0,x.jsxs)(p.Fragment,{children:[(0,x.jsx)(ee.A,{max_rating:a.aggregateRating.bestRating,rating:a.aggregateRating.ratingValue},a.aggregateRating.ratingValue),(0,x.jsx)(h.KJ,{inline:!0,size:"200",children:` ${a.aggregateRating.reviewCount} \xb7 ${e}`})]})}return null}var en=t(844255);let el=(void 0!==i||(i=t(916600)).hash&&"81db65fd15680cc0281b801ed4a8cb94"!==i.hash&&console.error("The definition of 'BestPinCardBody_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ei(e){let a,t;(0,p.useEffect)(()=>{(0,u.A)("BestPinCardBody","/app/packages/BestPinCard/BestPinCardBody.tsx")},[]);let{pinKey:n,viewportSize:l,pageType:i}=e,r=(0,m.A)(el,n),{pinCreditPrefix:s,pinLink:o}=(0,q.A)(r),d=(0,Q.A)(r),{description:c}=(0,Y.xe)({richMetadataDescription:r.richMetadata?.description,richSummaryDisplayName:r.richSummary?.displayName,closeupUnifiedDescription:r.closeupUnifiedDescription});"videos_category"===i.page&&(c=(0,Y.qX)(c,r.nativeCreator?.username||""));let g="wide"===l,y=(0,Y.rD)({pinTitle:r.title,gridTitle:r.gridTitle,richSummaryDisplayName:r.richSummary?.displayName??"",richMetadataTitle:r.richMetadata?.title??"",storyPinDataId:r.storyPinDataId,storyPinDataMetadataPinTitle:r.storyPinData?.metadata?.pinTitle,pinJoinVisualAnnotation:r.pinJoin?.visualAnnotation});(r.gridTitle||"").trim()&&y!==r.gridTitle&&(y=(0,Y.n2)(r.gridTitle,200));let f=(0,J.d)(r.richMetadata?.recipe?.name,!!r.richMetadata?.recipe?.categorizedIngredients,r.richMetadata?.recipe?.fromAggregatedData??!1)?r.richMetadata?.recipe:null,_=!!(r.richMetadata&&r.richMetadata.article&&r.richMetadata.article.datePublished)&&(t=(a=new Date((r.richMetadata??{}).article?.datePublished??Date.now())).getTime(),new Date().getTime()-t<=63072e6?(0,x.jsx)(G.A,{dateFormatType:G.c.LONG_MONTH_YEAR,useUTC:!1,value:a}):""),v=(e=>{let a,t,n="";if(e.richMetadata&&e.richMetadata.article&&e.richMetadata.article.datePublished)return n;let l=(a=null,e.lastRepinDate&&(a=new Date(e.lastRepinDate)),t=null,(e.createdAt&&(t=new Date(e.createdAt)),a)?t?a>t?a:t:a:t);if(l&&l.getFullYear()===new Date().getFullYear()){let a=new Set(["film_music_books","art","home_decor","food_drink","womens_fashion","travel","weddings","hair_beauty","holidays_events","mens_fashion","products","celebrities","technology"]),{category:t}=e;a.has(t)&&(n=l?(0,x.jsx)(G.A,{dateFormatType:G.c.LONG_MONTH_YEAR,useUTC:!1,value:l}):"")}return n})(r)||_,{isBot:k,isSocialBot:S}=(0,en._8)();return(0,x.jsx)(h.az,{alignContent:"between","data-test-id":"UnauthBestPinCardBodyContainer",direction:"column",display:"flex",flex:"grow",padding:8,position:"relative",width:"100%",children:(0,x.jsxs)(h.az,{direction:"column",display:"flex",flex:"grow",position:"relative",children:[(0,x.jsx)(W,{pageType:i,pin:{entityId:r.entityId,domain:r.domain||"",nativeCreator:r.nativeCreator&&{fullName:r.nativeCreator.fullName,username:r.nativeCreator.username}},pinCreditPrefix:"topic"===i.page&&r.nativeCreator?"Created by":s,pinLink:o??"",viewParameter:(0,X.A)({hasPin:!0,hasPinRichMetadata:!!r.richMetadata,hasPinRichMetadataProducts:!!r.richMetadata?.products,hasPinRichMetadataArticle:!!r.richMetadata?.article,hasPinRichMetadataRecipe:!!r.richMetadata?.recipe,hasPinStoryPinData:!!r.storyPinData})}),(0,x.jsx)(h.so,{direction:"row",justifyContent:"between",children:(0,x.jsx)(h.az,{display:"flex",marginEnd:3*!g,marginTop:3*!!g,overflow:"hidden",children:y&&(0,x.jsx)("h2",{"data-test-id":"UnauthBestPinCardTitle",style:{fontWeight:600,fontSize:"28px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:y})})}),v?(0,x.jsx)(h.az,{marginTop:1,children:(0,x.jsx)(h.KJ,{color:"subtle",children:v})}):null,c&&(0,x.jsx)(h.az,{display:"flex",marginTop:3,overflow:"hidden",children:(0,x.jsxs)("h3",{style:{fontWeight:"normal",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontSize:"14px"},children:[f&&(0,x.jsx)(et,{recipeKey:f}),c]})}),f&&(0,x.jsx)(Z.A,{marginOverrides:f?{outerMarginTop:32,ingredientMarginBottom:4}:null,recipeProps:{recipe:{categorizedIngredients:f.categorizedIngredients,name:f.name,image:(0,H.A)({imagesUrls:d,embedSrc:r.embed?.src,embedType:r.embed?.type,excludeOriginals:!k&&!S}),fromAggregatedData:f.fromAggregatedData}}}),(0,x.jsx)(h.az,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",marginTop:2,children:(0,x.jsx)(O,{pinKey:r})})]})})}var er=t(733577),es=t(610355);let eo={nw:0,ne:90,se:180,sw:270},ed={ne:[7,-7],se:[7,7],sw:[-7,7],nw:[-7,-7]},ec={nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};function eu({corner:e,x:a,y:t,size:n,cornerStyle:l}){return(0,p.useEffect)(()=>{(0,u.A)("CropperCorner","/app/packages/Cropper/CropperCorner.tsx")},[]),(0,x.jsxs)("g",{"data-test-id":`cropper-corner-${e}`,style:{cursor:ec[e],pointerEvents:"auto"},transform:((e,a,t,n)=>{if("rounded"!==n)return`translate(${a}, ${t}), rotate(${eo[e]})`;{let[n,l]=ed[e];return`translate(${a+n}, ${t+l}), rotate(${eo[e]})`}})(e,a,t,l),children:[(0,x.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:n,stroke:"none",width:n,x:0,y:0}),"rounded"===l?(0,x.jsx)("path",{className:`cropperHandle ${e}`,d:"M16 0H24V8H16C11.5817 8 8 11.5817 8 16V24H0V16C0 7.16343 7.16345 0 16 0Z",fill:"#fff"}):(0,x.jsx)("path",{className:`cropperHandle ${e}`,d:`M ${n} 0 L 0 0 L 0 ${n}`,fill:"none",stroke:"#fff",strokeWidth:6})]})}let ep={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize"};function eg({edge:e,x:a,y:t,w:n,h:l}){return(0,p.useEffect)(()=>{(0,u.A)("CropperEdge","/app/packages/Cropper/CropperEdge.tsx")},[]),(0,x.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:l,stroke:"none",style:{cursor:ep[e],pointerEvents:"auto"},width:n,x:a,y:t})}function eh({x:e,y:a,w:t,h:n}){(0,p.useEffect)(()=>{(0,u.A)("CropperHandles","/app/packages/Cropper/CropperHandles.tsx")},[]);let l="rounded";return(0,x.jsxs)(p.Fragment,{children:[(0,x.jsx)(eu,{corner:"nw",cornerStyle:l,size:20,x:e,y:a}),(0,x.jsx)(eu,{corner:"ne",cornerStyle:l,size:20,x:e+t,y:a}),(0,x.jsx)(eu,{corner:"sw",cornerStyle:l,size:20,x:e,y:a+n}),(0,x.jsx)(eu,{corner:"se",cornerStyle:l,size:20,x:e+t,y:a+n}),(0,x.jsx)(eg,{edge:"n",h:30,w:Math.max(t-40,0),x:e+20,y:a-10}),(0,x.jsx)(eg,{edge:"e",h:Math.max(n-40,0),w:30,x:e+t-20,y:a+20}),(0,x.jsx)(eg,{edge:"s",h:30,w:Math.max(t-40,0),x:e+20,y:a+n-10}),(0,x.jsx)(eg,{edge:"w",h:Math.max(n-40,0),w:30,x:e-20,y:a+20})]})}var em=t(470451),ey=t(156128),ef=t(131094),e_=t(168079),ev=t(931509);function ek(e){(0,p.useEffect)(()=>{(0,u.A)("Cropper","/app/packages/Cropper/Cropper.tsx")},[]);let{children:a,cropArea:t,imageSize:n,objectDetection:l,onChange:i,previewCropArea:r,showPreviewArea:s,viewParameter:o,viewType:d}=e,c=(0,U.A)(),g=(0,p.useRef)(null),m=(0,p.useRef)(null),[y,f]=(0,p.useState)(0),[_,v]=(0,p.useState)(0),[k,S]=(0,p.useState)(0),[b,w]=(0,p.useState)(0),[A,F]=(0,p.useState)((0,em.A)({cropArea:t,imageSize:n})),[P,I]=(0,p.useState)(null),[j,C]=(0,p.useState)(null),[T,R]=(0,p.useState)(!1),[K,D]=(0,p.useState)(!1),E=e=>{e.preventDefault(),e.stopPropagation();let{clientX:a,clientY:t}=e,n=a-y,l=t-_;D(!1),S(n),w(l);let i=e.target,r=i.classList.contains("cropperHandle"),s="shadowMask"===i.id,o="cropSection"===i.id,d=i.id===ey.z,c=i.id===ev.J4;r?(I("resize"),i.classList.contains("ne")?C("ne"):i.classList.contains("nw")?C("nw"):i.classList.contains("se")?C("se"):i.classList.contains("sw")?C("sw"):i.classList.contains("n")?C("n"):i.classList.contains("s")?C("s"):i.classList.contains("e")?C("e"):i.classList.contains("w")&&C("w")):s?(I("select"),F(er.Tg)):o?I("move"):(A.x<n&&n<A.x+A.w&&A.y<l&&l<A.y+A.h?I("move"):(I("select"),F(er.Tg)),R(d||c))},L=e=>{if(!P)return;R(!1);let{clientX:a,clientY:t}=e,l=a-y,i=t-_;if("resize"===P){let e=Math.max(Math.min(l,(n.width??1)-16),16),a=Math.max(Math.min(i,(n.height??1)-16),16);switch(!function(e,a,t,n,l){let{x:i,y:r,w:s,h:o}=t;switch(e){case"ne":n<i&&l>r+o?a("sw"):n<i?a("nw"):l>r+o&&a("se");break;case"nw":n>i+s&&l>r+o?a("se"):n>i+s?a("ne"):l>r+o&&a("sw");break;case"se":n<i&&l<r?a("nw"):n<i?a("sw"):l<r&&a("ne");break;case"sw":n>i+s&&l<r?a("ne"):n>i+s?a("se"):l<r&&a("nw");break;case"n":l>r+o&&a("s");break;case"s":l<r&&a("n");break;case"e":n<i&&a("w");break;case"w":n>i+s&&a("e")}}(j,C,A,e,a),j){case"ne":F(({x:t,y:n,h:l})=>{let i=Math.max(e-t,48),r=Math.max(l+(n-a),48);return{x:t,y:r<=48?n:a,w:i,h:r}});break;case"nw":F(({x:t,y:n,w:l,h:i})=>{let r=Math.max(l+(t-e),48),s=Math.max(i+(n-a),48);return{x:48===r?t:e,y:48===s?n:a,w:r,h:s}});break;case"se":F(({x:t,y:n})=>{let l=Math.max(e-t,48),i=Math.max(a-n,48);return{x:t,y:n,w:l,h:i}});break;case"sw":F(({x:t,y:n,w:l})=>{let i=Math.max(l+(t-e),48),r=Math.max(a-n,48);return{x:48===i?t:e,y:n,w:i,h:r}});break;case"n":F(({x:e,y:t,w:n,h:l})=>{let i=Math.max(t-a+l,48);return{x:e,y:48===i?t:a,w:n,h:i}});break;case"s":F(({x:e,y:t,w:n})=>{let l=Math.max(a-t,48);return{x:e,y:t,w:n,h:l}});break;case"e":F(({x:a,y:t,h:n})=>{let l=Math.max(e-a,48);return{x:a,y:t,w:l,h:n}});break;case"w":F(({x:a,y:t,w:n,h:l})=>{let i=Math.max(n-e+a,48);return{x:48===i?a:e,y:t,w:i,h:l}})}}else if("move"===P){let e=l-k,a=i-b,t=Math.max(Math.min(A.x+e,(n.width??1)-A.w-16),16),r=Math.max(Math.min(A.y+a,(n.height??1)-A.h-16),16);S(l),w(i),F(({w:e,h:a})=>({x:t,y:r,w:e,h:a}))}else if("select"===P){let e=Math.max(Math.min(l,n.width??1),0),a=Math.max(Math.min(i,n.height??1),0);F({x:Math.min(k,e),y:Math.min(b,a),w:Math.abs(e-k),h:Math.abs(a-b)})}},M=()=>{if(I(null),C(null),R(!1),P){if(T&&"dots"===l)return void D(!0);if(0===A.w&&0===A.h)i({cropArea:{x:16,y:16,w:(n.width??1)-32,h:(n.height??1)-32},cropSource:5}),c({event_type:16586,view_type:d,view_parameter:o});else{let e,a,t=Math.max(Math.min(A.x,(n.width??1)-48-16),16),l=Math.max(Math.min(A.y,(n.height??1)-48-16),16);e=A.h<48?48:l+A.h>(n.height??1)-16?(n.height??1)-l-16:A.h,a=A.w<48?48:t+A.w>(n.width??1)-16?(n.width??1)-t-16:A.w,"move"===P?c({event_type:7603,view_type:d,view_parameter:o}):"resize"===P?c({event_type:7604,view_type:d,view_parameter:o}):"select"===P&&c({event_type:16584,view_type:d,view_parameter:o}),i({cropArea:{x:t,y:l,w:a,h:e},cropSource:6})}}};return(0,e_.A)(()=>{if(m.current){let{x:e,y:a}=m.current.getBoundingClientRect();f(e),v(a)}}),(0,p.useEffect)(()=>{K&&F(t??er.Tg)},[t,K]),(0,p.useEffect)(()=>{let e=m.current;return e&&(e.addEventListener("mousedown",E),window.addEventListener("mousemove",L),window.addEventListener("mouseup",M)),()=>{e&&(e.removeEventListener("mousedown",E),window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",M))}}),(0,x.jsxs)(h.az,{ref:m,dangerouslySetInlineStyle:{__style:{cursor:"crosshair"}},"data-test-id":"visual-search-cropper",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:[(0,x.jsx)(ef.A,{unsafeCSS:er.jv}),(0,x.jsxs)("svg",{"data-gestalt-valid-html":"Box",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[(0,x.jsx)("defs",{children:(0,x.jsxs)("mask",{id:"Mask",children:[(0,x.jsx)("rect",{fill:"white",height:n.height??"100%",rx:"0",ry:"0",width:n.width??"100%",x:"0",y:"0"}),(0,x.jsx)("rect",{height:A.h,id:"hole",rx:0,ry:0,width:A.w,x:A.x,y:A.y},`${A.x}${A.y}`),(0,x.jsx)(es.A,{classNames:"preview-crop-area",in:s&&!P,mountOnEnter:!0,nodeRef:g,timeout:300,unmountOnExit:!0,children:(0,x.jsx)(h.az,{ref:g,children:(0,x.jsx)("rect",{height:r.h,id:"preview",rx:4,ry:4,width:r.w,x:r.x,y:r.y},`${r.x}${r.y}`)})})]})}),(0,x.jsx)("rect",{fill:"rgba(0,0,0,0.5)",height:"100%",id:"shadowMask",mask:"url(#Mask)",width:"100%",x:"0",y:"0"}),(0,x.jsx)("use",{className:"v2cropSection","data-test-id":"cropper-section",fill:"rgba(0,0,0,0)",href:"#hole",id:"cropSection",stroke:"white",strokeWidth:"2",style:{cursor:"move"}})]}),a,(0,x.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:"select"!==P&&(0,x.jsx)(eh,{h:A.h,w:A.w,x:A.x,y:A.y})})]})}function ex({showAnimation:e,auxData:a,index:t,isStela:n,onClick:l,onHover:i,onUnhover:r,spotlightCenter:s,viewParameter:o,viewType:d}){(0,p.useEffect)(()=>{(0,u.A)("FlashlightSpotlightDot","/app/packages/Flashlight/FlashlightSpotlightDot.tsx")},[]);let c=(0,U.A)(),g=n?1221:1260;(0,e_.A)(()=>{c({event_type:120,element:g,aux_data:a,view_parameter:o,view_type:d})});let h=parseFloat((.1*(t+1)).toFixed(2)),m={animation:e?`spotlightDotPop 0.6s ease-out ${h}s both`:"none"};return(0,x.jsx)(ey.A,{onClick:()=>{c({aux_data:a,element:g,event_type:101,view_parameter:o,view_type:d}),l(t)},onMouseEnter:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),i?.(t)},onMouseLeave:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),r?.()},style:m,x:s.x,y:s.y})}var eS=t(935504),eb=t(710278);let ew=`
@keyframes spotlightDotPop {
  0% {
    transform: scale(0);
  }

  100% {
    transform: scale(1);
  }
}`,eA=(void 0!==r||(r=t(340813)).hash&&"3a8409077905af94eb39568e4a5a57fc"!==r.hash&&console.error("The definition of 'FlashlightSpotlightDots_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),eF=({showAnimation:e,pinKey:a,imageSignature:t,imageSize:n,currentSpotlightIdx:l,handleSpotlightClick:i,handleSpotlightHover:r,handleSpotlightUnhover:s,viewParameter:o,viewType:d,visualObjects:c})=>{(0,p.useEffect)(()=>{(0,u.A)("FlashlightSpotlightDots","/app/packages/Flashlight/FlashlightSpotlightDots.tsx")},[]);let g=(0,m.A)(eA,a),h=(0,eS.A)(g),y=g?(g.visualObjects??[]).filter(e=>e.isStela):c??[];return(0,x.jsxs)(p.Fragment,{children:[(0,x.jsx)(ef.A,{unsafeCSS:ew}),y.map((a,c)=>{if(c===l)return null;let{x:u,y:p,w:m,h:y}=a,f=(0,eb.A)({cropArea:{x:u,y:p,w:m,h:y},scaledWidth:n.width??0,scaledHeight:n.height??0}),_={x:f.x+f.w/2,y:f.y+f.h/2},v={...h({override:{entrypoint:"flashlight"}}),pin_id:g?.entityId??"",image_signature:t,visual_objects:JSON.stringify([{x:a.x,y:a.y,w:a.w,h:a.h}])},k=`${_.x}${_.y}`;return(0,x.jsx)(ex,{auxData:v,index:c,isStela:!!a?.isStela,onClick:i,onHover:r,onUnhover:s,showAnimation:e,spotlightCenter:_,viewParameter:o,viewType:d},k)})]})};var eP=t(937092),eI=t(476410),ej=t(542758);let eC=(void 0!==s||(s=t(84216)).hash&&"939d46d8644385a7918ed8179ce77a4c"!==s.hash&&console.error("The definition of 'UnauthCropperContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eT({cropArea:e,customCropper:a,imageSignature:t,imageSize:n,pinKey:l,showAnimation:i,trafficSource:r,viewParameter:s,viewType:o}){(0,p.useEffect)(()=>{(0,u.A)("UnauthCropperContainer","/app/packages/Flashlight/UnauthCropperContainer.tsx")},[]);let d=(0,m.A)(eC,l),[c,g]=(0,p.useState)("none"),[h,y]=(0,p.useState)(!1),[f,_]=(0,p.useState)({x:0,y:0,w:0,h:0}),[v,k]=(0,p.useState)({isCropAreaOnDotArea:!1,indexToHide:-1}),{indexToHide:S}=v,b=(0,p.useMemo)(()=>(d.visualObjects??[]).filter(e=>e.isStela).map(ej.A),[d.visualObjects]);return(0,p.useEffect)(()=>{let a=b&&!!b.length,t=(0,eI.A)({cropArea:e,scaledHeight:n.height??0,scaledWidth:n.width??0});a&&(g("dots"),k((0,eP.A)(b,t)))},[e,n.height,n.width,b]),(0,x.jsx)(ek,{cropArea:e,imageSize:n,objectDetection:c,onChange:a,previewCropArea:f,showPreviewArea:!1,viewParameter:s,viewType:o,children:"dots"===c&&(0,x.jsx)(eF,{currentSpotlightIdx:S,handleSpotlightClick:e=>{let{x:t,y:l,w:i,h:s,title:o}=b[e];a({cropArea:(0,eb.A)({cropArea:{x:t,y:l,w:i,h:s},scaledHeight:n.height??0,scaledWidth:n.width??0}),cropSource:4,trafficSource:r,title:o||""})},handleSpotlightHover:e=>{if(e===S)return;let{x:a,y:t,w:l,h:i}=b[e];_((0,eb.A)({cropArea:{x:a,y:t,w:l,h:i},scaledWidth:n.width??0,scaledHeight:n.height??0})),y(!0)},handleSpotlightUnhover:()=>{y(!1)},imageSignature:t,imageSize:n,pinKey:d,showAnimation:i,viewParameter:s,viewType:o})},JSON.stringify(e))}var eR=t(115795),eK=t(901738),eD=t(319571),eE=t(67765),eL=t(803489),eM=t(566771),ez=t(780291),e$=t(937176),eB=t(270018),eO=t(360320);let eN=0,eV="",eU=(void 0!==o||(o=t(773353)).hash&&"0193da1983487c7c302a6a09a3f34b0a"!==o.hash&&console.error("The definition of 'UnauthDesktopFlashlightPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function eW(e){let{images_564x:a,images_orig:t,imageSignature:n}=e,l=a&&t,{url:i}=l??{},r=l?.width??1,s=l?.height??void 0;return"number"==typeof r&&"number"==typeof s&&r>564&&(s*=564/r,r=564),{width:r,height:s,url:i,imageSignature:n}}let eG=({data:e,index:a,viewParameter:t,productsURL:n})=>{switch(e.type){case"pin":return(0,x.jsx)(e$.A,{parentPinKey:null,pinKey:{type:"Legacy",data:e},slotIndex:a,viewParameter:t,viewType:72});case"story":return n&&(0,x.jsx)(K,{dangerouslySetActionUrl:n,slotIndex:a,story:e});default:return null}},eH=({resourceOptions:e})=>{let a=(0,f.A)(),{data:t,isAtEnd:n,isFetching:l,fetchMore:i}=(0,_.A)({name:"VisualLiveSearchResource",options:e}),r=(0,g.zy)(),s=`${r.pathname}products/${r.search}`;return(0,x.jsxs)(p.Fragment,{children:[t&&(0,x.jsx)(eO.A,{customLayoutType:"desktopFlashlight",feedItems:t.results||[],feedKey:"flashlight-dweb-unauth",pagination:{loadNext:i,hasNext:n,isLoadingNext:l,refetch:()=>void 0},renderFeedItem:(e,a)=>eG({data:e,index:a,viewParameter:3050,productsURL:s})}),(0,x.jsx)(h.y$,{accessibilityLabel:a.bt("Loading visual search results...", "Loading visual search results...", "unauthDesktopVisualSearch.flashlightFeed.loading", undefined, true),show:l})]})},eJ=({resourceOptions:e})=>{let a=(0,f.A)(),{data:t,isAtEnd:n,isFetching:l,fetchMore:i}=(0,_.A)({name:"VisualLiveSearchProductFeedResource",options:e});return(0,x.jsxs)(p.Fragment,{children:[t&&(0,x.jsx)(eO.A,{customLayoutType:"desktopFlashlight",feedItems:t||[],feedKey:"flashlight-products-dweb-unauth",pagination:{loadNext:i,hasNext:n,isLoadingNext:l,refetch:()=>void 0},renderFeedItem:(e,a)=>eG({data:e,index:a,viewParameter:3334})}),(0,x.jsx)(h.y$,{accessibilityLabel:a.bt("Loading visual search product results...", "Loading visual search product results...", "unauthDesktopVisualSearch.flashlightProductFeed.loading", undefined, true),show:l})]})};function eY({pinKey:e}){(0,p.useEffect)(()=>{(0,u.A)("UnauthDesktopFlashlightPage","/app/www/VisualSearch/UnauthDesktopFlashlightPage.tsx")},[]);let a=(0,f.A)(),{isRTL:t}=(0,en._8)(),n=(0,U.A)(),l=(0,g.Zp)(),i=(0,g.zy)(),r=(0,p.useRef)(null),{id:s}=(0,g.g)(),o=(0,eE.A)(),{pinId:d}=(0,v.A)(s||""),c=(0,eL.A)(i.search),y=(0,k.A)(i),_=function(e){let a=parseInt(e??"",10);switch(a){case 1:case 2:case 3:case 4:case 5:case 6:return a;default:return}}(c.cropSource),S=(0,eR.SM)(i),b=(0,m.A)(eU,e),{getNormalizedPinImage:w}=(0,eK.A)({pinKey:b});if((0,p.useEffect)(()=>{if(!y&&b){let{width:e,height:a}=w();l((0,ez.A)({cropArea:{h:a-32,w:e-32,x:16,y:16},isProductPage:S,pinId:d,surfaceType:"flashlight"}),{replace:!0})}},[w,l,y,S,b,d]),(0,e_.A)(()=>{n({event_type:13,view_type:72,view_parameter:3050,view_data:{pin_id:d}})}),(0,p.useEffect)(()=>{let e=r.current;return e&&eV===d&&(e.scrollTop=eN),()=>{e&&(eN=e.scrollTop,eV=d)}}),!b)return(0,x.jsx)(eD.A,{objectId:"",view:72,children:(0,x.jsx)(h.az,{dangerouslySetInlineStyle:{__style:{top:80}},position:"relative",children:(0,x.jsx)(h.y$,{accessibilityLabel:a.bt("Loading Pin data", "Loading Pin data", "unauthDesktopFlashlightPage.loadingPinData", undefined, true),show:!0})})});let{imageSignature:A,description:F}=b,{width:P,height:I,url:j}=eW(b),C=function({initialCropArea:e,pin:a}){let t;if(e)t={...e};else{let{visualObjects:e}=a,{width:n=1,height:l=1}=eW(a);if(e&&e.length){let{x:a,y:i,w:r,h:s}=e[0];t=(0,eb.A)({cropArea:{x:a,y:i,w:r,h:s},scaledWidth:n,scaledHeight:l})}else{let[e,a]=[n/6,l/6],[i,r]=[n-2*e,l-2*a];t={x:e,y:a,w:i,h:r}}}return{x:Math.floor(t.x??0),y:Math.floor(t.y??0),w:Math.floor(t.w??0),h:Math.floor(t.h??0)}}({initialCropArea:y,pin:b}),T=i.state&&i.state.internalNavigation,R=P+20,K=(R??1)+24,D={pin_id:d,imageSignature:A,crop:(0,eI.A)({cropArea:C,scaledWidth:P,scaledHeight:I}),crop_source:_||5},E={__style:{top:140}};return(0,x.jsx)(eD.A,{objectId:"",view:72,children:(0,x.jsxs)(p.Fragment,{children:[(0,x.jsxs)(h.az,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{top:80}},display:"flex",height:60,position:"fixed",width:"100%",zIndex:new h.rk(4),children:[!t&&(0,x.jsx)(h.az,{left:!0,position:"absolute",children:(0,x.jsx)(eB.default,{})}),(0,x.jsx)(h.az,{flex:"grow",children:(0,x.jsx)(h._Y,{align:"center",size:"400",children:S?a.bt("Shop for similar items", "Shop similar items", "unauthDesktopFlashlightPage.flashlightProductsFeed.header", undefined, true):a.bt("Visually similar results", "Visually similar results", "unauthDesktopFlashlightPage.flashlightFeed.header", undefined, true)})}),t&&(0,x.jsx)(h.az,{position:"absolute",right:!0,children:(0,x.jsx)(eB.default,{icon:"arrow-left"})})]}),S?(0,x.jsx)(h.az,{dangerouslySetInlineStyle:E,position:"relative",children:(0,x.jsx)(eJ,{resourceOptions:D})}):(0,x.jsxs)(h.az,{display:"flex",paddingX:12,children:[(0,x.jsxs)(h.az,{ref:r,dangerouslySetInlineStyle:E,height:"calc(100% - 140px)",marginEnd:3,marginStart:3,overflow:"auto",position:"fixed",width:R,zIndex:new h.rk(4),children:[(0,x.jsx)(h.az,{dangerouslySetInlineStyle:{__style:{width:P,height:I}},"data-test-id":"flashlight-enabled-image",children:(0,x.jsxs)(h.n1,{height:I,rounding:200,width:P,children:[j&&(0,x.jsx)(h._V,{alt:F??"",naturalHeight:I??1,naturalWidth:P??1,src:j}),(0,x.jsx)(eT,{cropArea:C,customCropper:function({cropArea:e,cropSource:a}){let t=window.location.pathname+window.location.search,n=(0,ez.A)({cropArea:e,cropSource:a??6,isProductPage:S,pinId:d,surfaceType:"flashlight"});o({action:"trigger",item:"cropper-changed",within:"flashlight-page"}),n!==t&&d&&l({pathname:`/pin/${d}/visual-search/`,search:(0,eM.A)({cropArea:e,cropSource:a??6,surfaceType:"flashlight"})},{state:{internalNavigation:!0}})},imageSignature:A??void 0,imageSize:{height:I,width:P},pinKey:b,showAnimation:!T,surfaceType:"flashlight",viewParameter:3050,viewType:72})]})}),(0,x.jsx)(h.az,{"data-test-id":"closeupDescription",direction:"column",display:"flex",margin:5,maxWidth:P??1,position:"relative",children:(0,x.jsx)(ei,{pageType:{isAuth:!1,page:"flashlight"},pinKey:b,viewportSize:"narrow"})})]}),(0,x.jsx)(h.az,{dangerouslySetInlineStyle:{__style:{...E.__style,...t?{marginRight:`${K}px`}:{marginLeft:`${K}px`}}},position:"relative",width:"100%",children:(0,x.jsx)(eH,{resourceOptions:D})})]})]})})}let eq=(void 0!==d||(d=t(281815)).hash&&"01839fc3bcd9cdaf206873364167d157"!==d.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d),eQ=(void 0!==c||(c=t(941734)).hash&&"76ab21d7bfe8df8a1418aea805bb41fa"!==c.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchDataPinQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),c);function eX(){let{id:e}=(0,g.g)(),{pinId:a}=(0,v.A)(e||""),t=(0,y.A)({strategy:"Legacy",query:eQ,variables:{pinId:a},useGetLegacyData:({pinId:e})=>(0,_.A)({name:"PinResource",options:{id:e,field_set_key:"detailed",fetch_visual_search_objects:!0}}).data}),n=t?.v3GetPinQuery?.__typename==="V3GetPin"?t.v3GetPinQuery.data:null,l=(0,m.A)(eq,n);return(0,x.jsx)(eY,{pinKey:l})}function eZ(){(0,p.useEffect)(()=>{(0,u.A)("UnauthDesktopFlashlightPageFetchData","/app/www/VisualSearch/UnauthDesktopFlashlightPageFetchData.tsx")},[]);let e=(0,f.A)();return(0,x.jsx)(p.Suspense,{fallback:(0,x.jsx)(h.y$,{accessibilityLabel:e.bt("Loading Pin data", "Loading Pin data", "unauthDesktopFlashlightPage.loadingPinData", undefined, true),show:!0}),children:(0,x.jsx)(eX,{})})}},720575(e,a,t){t.d(a,{A:()=>c});var n=t(61163),l=t(859471),i=t(676692),r=t(33658),s=t(970042),o=t(562615);class d extends l.Component{componentDidMount(){let{setCurrentPageData:e,viewData:a,viewParameter:t,viewType:n}=this.props;e({viewData:a,viewParameter:t,viewType:n})}componentDidUpdate(e){let{setCurrentPageData:a,viewData:t,viewParameter:n,viewType:l}=this.props;n===e.viewParameter&&l===e.viewType&&(0,r.Ay)(t,e.viewData)||a({viewData:t,viewParameter:n,viewType:l})}componentWillUnmount(){this.props.clearCurrentPageData()}render(){let{auxData:e,children:a,component:t,objectIdStr:n,viewData:l,viewParameter:i,viewType:r,clientTrackingParams:d}=this.props;return(0,o.jsx)(s.A,{auxData:e,clientTrackingParams:d,component:t,objectIdStr:n,viewData:l,viewParameter:i,viewType:r,children:a})}}function c(e){(0,l.useEffect)(()=>{(0,n.A)("PageView","/app/www/analytics/PageView.tsx")},[]);let{setViewContextData:a,clearViewContextData:t}=(0,i.x)();return(0,o.jsx)(d,{...e,clearCurrentPageData:t,setCurrentPageData:a})}},970042(e,a,t){t.d(a,{A:()=>r});var n=t(859471),l=t(743372),i=t(752159);function r(e){let{auxData:a,clientTrackingParams:t,children:r,component:s,element:o,objectIdStr:d,viewData:c,viewParameter:u,viewType:p}=e,g=(0,l.A)(),h=JSON.stringify(a),m=JSON.stringify(c);return(0,n.useEffect)(()=>{(({viewType:e,viewParameter:a,viewData:t,auxData:n,objectIdStr:l,component:r,clientTrackingParams:s,element:o},d)=>{let c,u=Object.keys(c={event_type:13,view_type:e,view_parameter:a,view_data:t,aux_data:n,object_id_str:l,component:r,clientTrackingParams:s,element:o}).reduce((e,a)=>(void 0===c[a]&&delete e[a],e),{...c});-1===Object.keys(u).indexOf("view_type")&&(0,i.PM)("mweb.logging.null_view_type"),d(u)})(e,g)},[g,h,t,s,o,d,m,u,p]),n.Children.only(r)}},707846(e,a,t){t.d(a,{A:()=>eX});var n,l,i,r,s,o,d,c,u,p,g,h=t(61163),m=t(859471);t(825193);var y=t(979638),f=t(19821),_=t(668014),v=t(535273),k=t(219053),x=t(538329),S=t(161916),b=t(75840),w=t(337492),A=t(999813),F=t(412909),P=t(81075);t(733577);var I=t(693154),j=t(901738),C=t(803489),T=t(985007),R=t(476410),K=t(925819),D=t(140432),E=t(203168),L=t(537070),M=t(729617),z=t(586733),$=t(168079),B=t(385800),O=t(562615);function N({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,isSelected:n,label:l,onTap:i,ref:r,selectedPillColor:s}){(0,m.useEffect)(()=>{(0,h.A)("DescriptorPill","/app/www/Descriptors/DescriptorPill.tsx")},[]);let[o,d]=(0,m.useState)(e);return(0,m.useEffect)(()=>{d(n?s:e)},[n,s,e]),(0,O.jsx)(f.Rp,{onMouseDown:()=>d(t),onMouseEnter:()=>{n||d(a)},onMouseLeave:()=>{n||d(e)},onTap:i,rounding:400,tapStyle:"compress",children:(0,O.jsx)(f.az,{ref:r,dangerouslySetInlineStyle:{__style:{background:o,backdropFilter:"blur(80px)",userSelect:"none"}},"data-test-id":`descriptor-pill-${l}`,paddingX:4,paddingY:2,rounding:400,children:(0,O.jsx)(f.so,{alignItems:"center",minHeight:32,children:(0,O.jsx)(f.Wu,{color:n?"light":"dark",overflow:"noWrap",children:l})})})})}let V=({showBackArrow:e,showFwdArrow:a,handleClickBack:t,handleClickForward:n})=>{(0,m.useEffect)(()=>{(0,h.A)("DescriptorsNavigation","/app/www/Descriptors/DescriptorsNavigation.tsx")},[]);let l=(0,x.A)();return(0,O.jsxs)(f.az,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"descriptors-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginStart:2,children:e&&(0,O.jsx)(f.K0,{accessibilityLabel:l.bt("Back", "Back", "descriptor.navArrow.back", undefined, true),bgColor:"default",dataTestId:"descriptor-bar-back-button",icon:"chevron-left",onClick:t,size:"md"})}),(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginEnd:2,children:a&&(0,O.jsx)(f.K0,{accessibilityLabel:l.bt("Forwards", "Forward", "descriptor.navArrow.forward", undefined, true),bgColor:"default",dataTestId:"descriptor-bar-forward-button",icon:"chevron-right",onClick:n,size:"md"})})]})};var U=t(844255);let W=(void 0!==n||(n=t(279925)).hash&&"9d15639e8d9dd61426917dc218fbb3a6"!==n.hash&&console.error("The definition of 'Descriptors_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function G({pressedPillColor:e,defaultPillColor:a,descriptorModules:t,hoveredPillColor:n,pinKey:l,selectedPillColor:i,isWebImageSearchRedesign:r}){(0,m.useEffect)(()=>{(0,h.A)("Descriptors","/app/www/Descriptors/Descriptors.tsx")},[]);let[s,o]=(0,m.useState)(),[d,c]=(0,m.useState)(0),u=(0,y.Zp)(),{search:p}=(0,y.zy)(),{barContainer:g,clientWidth:_,allModulesFit:k,offset:x,showBackArrow:S,showFwdArrow:b,handleClickForward:w,handleClickBack:A,onFocus:F,onMouseDown:P,scrollToPillByOffset:I}=(e=>{let a=(0,m.useRef)(null),{isRTL:t}=(0,U._8)(),n=(0,m.useRef)(!1),[l,i]=(0,m.useState)(0),[r,s]=(0,m.useState)(0),[o,d]=(0,m.useState)(!1),[c,u]=(0,m.useState)(!1),{current:p}=a,{clientWidth:g=0,scrollWidth:h=0}=p??{},y=g||0,f=!!p&&y>=(h||0),_=e.length;(0,m.useEffect)(()=>{let e=p?.scrollWidth||0,a=0;Array.from(p?.children||[]).slice(0,l).forEach(e=>{a+=e.offsetWidth||0}),s(a=Math.min(a,e-g+8));let t=e-a,n=y>=e;n&&0!==l&&i(0),d(l>0&&!n),u(t>y&&l<_&&!n)},[p,l,_,y,t,g]);let v=(0,m.useCallback)(e=>{if(!p)return;let a=Array.from(p.children);if(e<0||e>=a.length)return;let t=0;a.slice(0,e).forEach(e=>{t+=e?.offsetWidth??0});let n=a[e]?.offsetWidth??0;if(t<r){s(t),i(e);return}if(t+n>r+g){s(t+n-g),i(e);return}i(e)},[p,r,g]),k=(0,m.useCallback)((e,a)=>{let t=e.current;if(!t||a<0||a>=t.length)return;let n=Array.from({length:a}).reduce((e,a,n)=>e+(t[n]?.offsetWidth??0),0),l=n+(t[a]?.offsetWidth??0);if(n>=r&&l<=r+g)return;let o=n<r?n:l-g;s(Math.max(0,Math.min(o,Math.max(0,h-g+8)))),i(Array.from({length:t.length}).reduce((e,a,n)=>{let{foundIndex:l,accWidth:i}=e;if(-1!==l)return e;let r=i+(t[n]?.offsetWidth??0);return{foundIndex:i>=o?n:-1,accWidth:r}},{foundIndex:-1,accWidth:0}).foundIndex)},[r,g,h]),x=(0,m.useCallback)(e=>{if("Tab"!==e.key)return;let a=Array.from(p?.children||[]),t=document.activeElement,n=a.findIndex(e=>e.contains(t));-1!==n&&(!e.shiftKey&&n<a.length-1?v(n+1):e.shiftKey&&n>0&&v(n-1))},[p,v]);return(0,m.useEffect)(()=>{if(p)return p.addEventListener("keydown",x,!0),()=>{p.removeEventListener("keydown",x,!0)}},[p,x]),{barContainer:a,allModulesFit:f,clientWidth:g,offset:r,showBackArrow:o,showFwdArrow:c,onFocus:()=>{n.current||i(l)},index:l,setIndex:i,handleClickForward:()=>{l+2<_?i(l+2):i(_-2)},handleClickBack:()=>{l-2>=0?i(l-2):i(0)},onMouseDown:()=>{n.current=!0},scrollToPillByOffset:k}})(t),j=(0,v.A)(W,l),{logContextEvent:T}=(0,z.o)(),{descriptorsRefs:R}=((e,a,t,n,l)=>{let{logContextEvent:i}=(0,z.o)(),r=(0,m.useRef)([]),s=(0,m.useRef)([]);return(0,m.useEffect)(()=>{let o=0,d=r.current.map((n,l)=>{let i=n?.offsetWidth||0,r=o,s=o+i;o+=i+4;let{auxData:d}=t[l]||{auxData:{}},c=e+a,u=r+16>e&&r<c,p=s>e&&s-16<c;return{moduleId:d?.moduleId||"",isVisible:u||p}});d.forEach((e,a)=>{let t=s.current[a];if((!t||!1===t.isVisible)&&e.isVisible){let{auxData:e}=l||{};i({event_type:9993,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:n||"",descriptor:e?.query}})}}),s.current=d},[r,e,a,t,i,n,l,s]),{descriptorsRefs:r}})(x,_,t,j.imageSignature||"",s);(0,$.A)(()=>{if(void 0===s){let e=t.findIndex(e=>{let{display:a}=e,{isSelected:t}=a||{isSelected:!1};return t}),{hybrid_search_param:a}=(0,C.A)(p);-1!==e&&a&&(o(t[e]),I(R,e-1))}}),(0,m.useEffect)(()=>{c(r?(e=>{if(!e)return 0;let a=e.getBoundingClientRect(),t=window.innerHeight;return a.bottom>t?a.bottom-t:0})(g.current):0)},[g,r]);let K=e=>{let{id:a}=e,{id:t}=s||{};return null!=a&&t===a};return(0,O.jsx)(B.e,{children:({hovered:l,onMouseEnter:r,onMouseLeave:c})=>(0,O.jsxs)(f.az,{dangerouslySetInlineStyle:{__style:{bottom:d}},"data-test-id":"scrollable-descriptor-bar-root",left:!0,onMouseEnter:r,onMouseLeave:c,overflow:"hidden",position:"absolute",right:!0,children:[(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{left:`-${x}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,O.jsx)(f.az,{ref:g,display:"flex",justifyContent:k?"start":void 0,marginStart:2,paddingY:2,children:t.map((t,l)=>{let{action:r,display:s}=t,{feedUrl:d}=r||{};if(null==d)return null;let{displayText:c}=s||{};return(0,O.jsx)(f.az,{marginEnd:1,onFocus:F,onMouseDown:P,children:(0,O.jsx)(N,{ref:e=>{R.current[l]=e},defaultPillColor:a,hoveredPillColor:n,isSelected:K(t),label:c||"",onTap:()=>((e,a)=>{let t=K(e),{action:n}=e,{feedUrl:l}=n||{};l&&(t?((e=>{let a=e,{surfaceType:t}=(0,C.A)(p);t&&(a=e.replace(RegExp(`^(.*surfaceType=${t}).*$`),"$1")),u(a??"",{replace:!0})})(l),o(void 0)):((e=>{let{surfaceType:a}=(0,C.A)(p),t=e;a&&(t=e.replace(/(surfaceType=)[^&]*/,`$1${a}`)),u(t??"",{replace:!0})})(l),I(R,a),o(e)));let{auxData:i}=e;T({event_type:102,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:j.imageSignature||"",descriptor:i?.query}})})(t,l),pressedPillColor:e,selectedPillColor:i})},`descriptors-module-${t.id||l}`)})})}),l&&(0,O.jsx)(V,{handleClickBack:()=>{A();let{auxData:e}=s||{};T({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:j.imageSignature||"",descriptor:e?.query}})},handleClickForward:()=>{w();let{auxData:e}=s||{};T({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:j.imageSignature||"",descriptor:e?.query}})},showBackArrow:S,showFwdArrow:b})]})})}var H=t(860176),J=t(205392);function Y({containerRef:e}){let a=(0,m.useCallback)(()=>{(0,J.Uy)("VisualSearchImageRender")},[]);return(0,m.useEffect)(()=>{let t=e.current;if(!t)return;let n=t.querySelector("img");n?.complete&&n.naturalWidth>0&&a()},[e,a]),{onImageLoad:a}}var q=t(307273),Q=t(788284),X=t(937092),Z=t(566771),ee=t(946013),ea=t(180154),et=t(676791);let en=(void 0!==l||(l=t(108026)).hash&&"fbf2d3b93402a9dd783073db316c0f92"!==l.hash&&console.error("The definition of 'VisualSearchCropper_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function el({cropArea:e,cropSource:a,entrypoint:t,imageContainerX:n=0,imageContainerY:l=0,imageSize:i,pinKey:r,trafficSource:s,viewParameter:o,viewType:d}){(0,m.useEffect)(()=>{(0,h.A)("VisualSearchCropper","/app/www/VisualSearch/VisualSearchCropper.tsx")},[]);let c=(0,v.A)(en,r),u=(0,y.Zp)(),p=(0,K.f)(),{id:g}=(0,y.g)(),{pinId:f}=(0,w.A)(g??""),{getNormalizedPinImage:_}=(0,j.A)({pinKey:c,maxWidth:446}),k=(0,ea.A)({pinKey:c,isVisualSearch:!0}),[x,S]=(0,m.useState)(null),{bitmap_masks:b}=k??{},A=(0,m.useMemo)(()=>(b??[]).filter(et.B1),[b]),F=(0,m.useMemo)(()=>A.map(e=>{let{id:a,mask_bounds:t}=e,[n,l]=t[0],[i,r]=t[1];return{x:n,y:l,w:i,h:r,id:a}}),[A]),P=A.length>0,I=(0,m.useMemo)(()=>{if(!P)return -1;let a=(0,R.A)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0});return(0,X.A)(F,a).indexToHide},[e,F,P,i.height,i.width]);return(0,O.jsx)(Q.A,{cropArea:e,cropSource:a,hoveredCutoutIndex:x,imageContainerX:n,imageContainerY:l,imageSize:i,objectDetection:P?"cutouts":"none",onChange:({cropArea:e,cropSource:a})=>{if(P){let t=(0,R.A)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0}),{isCropAreaOnDotArea:n}=(0,X.A)(F,t);n&&(a=9)}let n=window.location.search,l=(0,Z.A)({cropArea:e,cropSource:a,entrypoint:t,trafficSource:s});n!==l&&u({pathname:window.location.pathname,search:l},{replace:!0})},pinId:f,setHoveredCutoutIndex:S,viewParameter:o,viewType:d,children:(()=>{if(!P)return null;let{pinImageWidth:e,pinImageHeight:a,pinImageUrl:i}=(()=>{if(p)return{pinImageWidth:520,pinImageHeight:520/(c?.image?.width??1)*(c?.image?.height??1),pinImageUrl:c?.image?.url??""};let{height:e,width:a,url:t}=_();return{pinImageWidth:a,pinImageHeight:e,pinImageUrl:t}})();return(0,O.jsx)(ee.default,{bitmapMasks:A,entrypoint:t,hoveredCutoutIndex:x,imageContainerX:n,imageContainerY:l,pinId:f,pinImageHeight:a,pinImageUrl:i,pinImageWidth:e,selectedCutoutIndex:I,setHoveredCutoutIndex:S,trafficSource:s,viewParameter:o,viewType:d})})()})}let ei=(void 0!==i||(i=t(327310)).hash&&"727c8ab2c1c256e3b4478a36890f92d6"!==i.hash&&console.error("The definition of 'RelatedProductsImageContent_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function er({cropArea:e,cropSource:a,entrypoint:t,description:n,descriptorModules:l,height:i,imageContainerX:r,imageContainerY:s,imageUrl:o,pinKey:d,trafficSource:c,viewParameter:u,viewType:p,width:g}){(0,m.useEffect)(()=>{(0,h.A)("RelatedProductsImageContent","/app/common/react/components/shopping/RelatedProducts/RelatedProductsImageContent.tsx")},[]);let y=(0,K.f)(),_=(0,v.A)(ei,d),{defaultColor:k,selectedColor:x,hoveredColor:S,pressedColor:b}=(0,H.A)(_.dominantColor),{height:w=0}=(0,M.A)()||{},A=(0,m.useRef)(null),{onImageLoad:F}=Y({containerRef:A}),P=s+i,I=P>w,j=I?Math.min(P-64-12,w-64-12):i-64;return(0,O.jsxs)(f.az,{"data-test-id":"flashlight-enabled-image",height:i,width:g,children:[(0,O.jsxs)(f.n1,{height:i,rounding:y?600:400,width:g,children:[(0,O.jsx)(L.A,{_enableViewTransitions:!0,type:"image",children:(0,O.jsx)(f.az,{ref:A,children:(0,O.jsx)(f._V,{alt:n,naturalHeight:i,naturalWidth:g,onLoad:F,src:o})})}),(0,O.jsx)(el,{cropArea:e,cropSource:a,entrypoint:t,imageContainerX:r,imageContainerY:s,imageSize:{height:i,width:g},pinKey:_,trafficSource:c,viewParameter:u,viewType:p}),y&&(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{insetInlineStart:0}},position:"absolute",top:!0,children:(0,O.jsx)(q.A,{defaultPillColor:k,hoveredPillColor:S,pressedPillColor:b,viewParameter:u,viewType:p})})]}),l&&l.length>0&&(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{top:j}},height:64,position:I?"fixed":"absolute",width:g,children:(0,O.jsx)(G,{defaultPillColor:k,descriptorModules:l,hoveredPillColor:S,pinKey:_,pressedPillColor:b,selectedPillColor:x})})]})}var es=t(754150),eo=t(836664),ed=t(269016),ec=t(106301);function eu({itemCount:e}){let a=(0,m.useRef)(!1);(0,m.useEffect)(()=>{!a.current&&e>0&&(a.current=!0,(0,J.Uy)("VisualSearchFeedRender"))},[e])}let ep=(void 0!==r||(r=t(94762)).hash&&"20c2c7f4ff982fb93a9608faa14f3ed2"!==r.hash&&console.error("The definition of 'RelatedProductsUnifiedFeed_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eg({alignStart:e,auxData:a,isFilterOpened:t,isProductOnlyFeed:n,oneBarModules:l,pinKey:i,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o}){(0,m.useEffect)(()=>{(0,h.A)("RelatedProductsUnifiedFeed","/app/common/react/components/shopping/RelatedProducts/UnifiedFeed/RelatedProductsUnifiedFeed.tsx")},[]);let d=(0,v.A)(ep,i),c=!n&&l&&l.length>0,{data:u}=o,p=u?.search_identifier;return eu({itemCount:(u?.results||[]).length}),(0,O.jsxs)(m.Fragment,{children:[c&&(0,O.jsx)(f.az,{position:"relative",zIndex:new f.rk(1),children:(0,O.jsx)(ec.n,{children:(0,O.jsx)(eo.Q,{children:(0,O.jsx)(es.default,{oneBarModulesKey:null,oneBarModulesRest:l,paddingX:8})})})}),(0,O.jsx)(f.az,{overflow:"hidden",children:(0,O.jsx)(ed.A,{alignStart:e,auxData:a,isFilterOpened:t,isProductFeed:n,pinKey:d,searchId:p,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o})})]})}var eh=t(302322),em=t(348681),ey=t(319571);function ef({cropSource:e}){return{viewType:72,viewParameter:9===e?3462:3050}}var e_=t(808571),ev=t(788446);let ek=E.G+16,ex=(void 0!==s||(s=t(316564)).hash&&"3a9a747c3135f426fe0cf32ca9147a5d"!==s.hash&&console.error("The definition of 'VisualSearchContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eS({cropArea:e,cropSource:a,entrypoint:t,isProductPage:n,oneBarModules:l,pinKey:i,searchId:r,descriptorModules:s,title:o,trafficSource:d,visualSearchFlashlightUnifiedResource:c}){(0,m.useEffect)(()=>{(0,h.A)("VisualSearchContainer","/app/www/VisualSearch/VisualSearchContainer.tsx")},[]);let u=(0,v.A)(ex,i),{getNormalizedPinImage:p}=(0,j.A)({pinKey:u,maxWidth:446}),g=(0,y.zy)(),{width:_=0}=(0,M.A)()||{},k=(0,e_.g)(),x=(0,ev.A)(),{imageContainerScrollTop:S,imageContainerScrollTopForPinId:b}=(0,eh.U)(),w=(0,m.useRef)(null),[A,F]=(0,m.useState)(0),[P,I]=(0,m.useState)(0),{state:C}=g||{},{internalNavigation:T=!1}=C||{},{width:R,height:K,url:D}=p(),L=R+20,z=n?0:L+48,B=_-x-z-20,{viewType:N,viewParameter:V}=ef({cropSource:a}),U={commerce_data:JSON.stringify({is_product_only_feed:n})},W=()=>{let e=w.current;if(e){let{x:a,y:t}=e.getBoundingClientRect(),{scrollTop:n}=e;F(a),I(t-n)}};return(0,$.A)(()=>{W(),w.current&&0!==S.current&&b.current===u.entityId&&(w.current.scrollTop=S.current)}),(0,O.jsx)(ey.A,{objectId:r,view:N,children:(0,O.jsx)(em.A,{log:{aux_data:U,view_type:N,view_parameter:V},children:(0,O.jsxs)(f.az,{"data-test-id":"related-products",children:[(0,O.jsx)(E.A,{isProductPage:n,title:n?o:"",viewParameter:V,viewType:N}),!n&&(0,O.jsx)(f.az,{ref:w,bottom:!0,dangerouslySetInlineStyle:{__style:{top:k+ek,left:x,right:x}},height:"inherit",marginBottom:3,marginStart:12,onScroll:()=>{W(),S.current=w.current?.scrollTop||0,b.current=u.entityId},overflow:"auto",position:"fixed",width:L,children:(0,O.jsx)(er,{cropArea:e,cropSource:a,description:u.description??"",descriptorModules:s,entrypoint:t,height:K,imageContainerX:A,imageContainerY:P,imageSignature:u.imageSignature||"",imageUrl:D,pinKey:u,showAnimation:!T,trafficSource:d,viewParameter:V,viewType:N,width:R})}),(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{top:n?0:ek,left:z,right:z}},paddingX:4,position:"relative",width:B,children:(0,O.jsx)(eg,{auxData:U,isProductOnlyFeed:n,oneBarModules:l,pinKey:u,viewParameter:V,viewType:N,visualSearchFlashlightUnifiedResource:c})})]})})})}var eb=t(694804),ew=t(210909),eA=t(601185),eF=t(538678),eP=t(284966),eI=t(937176),ej=t(699613),eC=t(8627),eT=t(679051),eR=t(726329),eK=t(17881),eD=t(881541);let eE=(void 0!==o||(o=t(193933)).hash&&"b1061aefab46af37d4c9716916386af2"!==o.hash&&console.error("The definition of 'VisualSearchCarousel_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function eL({componentType:e,hasActionCTA:a,legacyStory:t,searchIdentifier:n,storyKey:l,trafficSource:i,viewParameter:r,viewType:s}){(0,m.useEffect)(()=>{(0,h.A)("VisualSearchCarousel","/app/www/VisualSearch/VisualSearchCarousel.tsx")},[]);let o=(0,y.zy)(),d=(0,v.A)(eE,l),c=(0,eR.bi)({clientTrackingParams:d?.trackingParams,componentType:e,contextLogData:{story_id:d?.storyId,story_type:d?.storyType,content_ids:d?.contentIds},impressionType:"Story",loggingId:d?.storyId,slotIndex:0,viewParameter:r,viewType:s}),u=(0,m.useCallback)(({item:e,index:t})=>{if(a&&d.objects&&t===d.objects.length-1){let a=e.images?.["236x"]?.url,t=new URLSearchParams(o.search);t.set("entrypoint","feed_module");let n=`${o.pathname}products/?${t.toString()}`;return a&&(0,O.jsx)(eK.A,{buttonText:d.action?.text||"See more",component:14339,dataTestId:"shop-action-item-button",element:179,imageWidth:eT.A,previewImageSrc:a,storyId:d.storyId??void 0,storyType:d.storyType,url:n,view:s,viewParameter:r})}return(0,O.jsx)(eI.A,{componentType:14339,isInDesktopCarousel:!0,parentPinKey:null,pinImageCrop:{width:eT.A,height:eT.A},pinKey:{type:"Legacy",data:e},slotIndex:t,surface:"VisualInspirationShoppingPin",trafficSource:i,viewData:{search_identifier:n},viewParameter:r,viewType:s})},[a,d.objects,d.action?.text,d.storyId,d.storyType,i,n,r,s,o]),p=t?.objects?.filter(e=>"pin"===e.type);return p&&0!==p.length?(0,O.jsx)(f.az,{ref:c,"data-test-id":"visual-search-carousel",children:(0,O.jsx)(eD.A,{items:p,itemWidth:eT.A,parentPinKey:null,renderItem:u,showBorder:!0,showMarkers:!0,storyKey:d,view:s,viewParameter:r})}):null}var eM=t(510489);let ez=({oneBarModules:e,masonryScrollContainerRef:a,hasShopModuleStory:t})=>{(0,m.useEffect)(()=>{(0,h.A)("VisualSearchOneBar","/app/www/VisualSearch/VisualSearchOneBar.tsx")},[]);let{transitionStyle:n,position:l}=(({masonryScrollContainerRef:e,hasShopModuleStory:a,oneBarModules:t})=>{let[n,l]=(0,m.useState)(!1),i=(0,e_.g)(),r=t?.some(e=>e.display?.isSelected),{checkExperiment:s}=(0,eA.A)(),o=s("web_pin_level_landing_feed_one_bar").anyEnabled,d=r||!o;return(0,m.useEffect)(()=>{let t=()=>{let t=e.current;if(t){let{y:e}=t.getBoundingClientRect();l(e-i<=(a?-250:-10))}};return window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}},[i,a,e]),{transitionStyle:d?void 0:{transform:n?"translateY(0)":"translateY(-100%)",transition:"all 0.3s ease-in-out",width:"100%"},position:d?"sticky":"fixed"}})({masonryScrollContainerRef:a,oneBarModules:e,hasShopModuleStory:t});return(0,O.jsx)(eM.A,{position:l,shouldShowShadow:!0,style:n,children:(0,O.jsx)(ec.n,{children:(0,O.jsx)(eo.Q,{children:(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{paddingInlineEnd:"8px"}},children:(0,O.jsx)(es.default,{itemHeight:48,marginBottom:0,oneBarModulesKey:null,oneBarModulesRest:e,paddingBottom:12,paddingX:3})})})})})};function e$({auxData:e,isProductOnlyFeed:a,oneBarModules:t,trafficSource:n,viewParameter:l,viewType:i,visualSearchFlashlightUnifiedResource:r}){(0,m.useEffect)(()=>{(0,h.A)("VisualSearchFeed","/app/www/VisualSearch/VisualSearchFeed.tsx")},[]);let s=(0,x.A)(),{logContextEvent:o}=(0,z.o)(),d=(0,m.useRef)(!1),c=(0,m.useRef)(null),{checkExperiment:u}=(0,eA.A)(),p=u("web_pin_grid_last_visited").anyEnabled,g=(0,ej.HR)(),y=!a&&t&&t.length>0,{data:_,isFetching:v,fetchMore:k,isAtEnd:S}=r,{results:b=[],search_identifier:w}=_||{};eu({itemCount:b.length});let A=b.find(e=>"story"===e.type&&"stela_shop"===e.story_type),{action:F,objects:P}=A||{},{text:I,url:j}=F||{},C=P?.length||0,T=!!(I&&j),R=(0,eP.A)(()=>{d.current||(o({event_type:110,view_type:i,view_parameter:l}),d.current=!0)},1e3),K=(0,m.useCallback)(({data:t,itemIdx:r})=>{if("story"===t.type)return"unified_entry_point_flashlight_header"===t.story_type?null:(0,O.jsx)(eL,{auxData:e,componentType:14339,hasActionCTA:T,legacyStory:t,searchIdentifier:w,storyKey:{type:"Legacy",data:t},trafficSource:n,viewParameter:l,viewType:i});if("pin"===t.type){let s=+!!T,o=g(t.id),d=(0,O.jsx)(eI.A,{auxData:e,componentType:0,parentPinKey:null,pinKey:o?{type:"Legacy",data:o}:null,slotIndex:r+C-s,surface:a?"ShoppingDynamicHeightGrid":"SearchItem",trafficSource:n,viewData:{search_identifier:w},viewParameter:l,viewType:i});return p?(0,O.jsx)(eC.A,{children:d}):d}return null},[e,w,n,i,l,T,C,a,p]),D=(0,m.useCallback)(e=>"story"!==e.type,[]);return(0,O.jsxs)(m.Fragment,{children:[y&&(0,O.jsx)(ez,{hasShopModuleStory:!!A,masonryScrollContainerRef:c,oneBarModules:t}),(0,O.jsx)(f.az,{ref:c,"data-test-id":"visual-search-feed",onScroll:R,overflow:"hidden",children:(0,O.jsx)(eF.A,{isAtEndOfFeed:S,itemCount:b.length,children:(0,O.jsx)(ew.default,{align:a?"center":"start",getColumnSpanConfig:e=>{let a="story"===e.type&&e.display_options?.num_columns_requested;return 0===a?1/0:a||1},isFetching:v,isLoadedAccessibilityLabel:s.bt("Visual search results loaded", "Visual search results loaded", "visualSearch.masonry.loaded.label", undefined, true),isLoadingAccessibilityLabel:s.bt("Loading visual search results", "Loading visual search results", "visualSearch.masonry.loading.label", undefined, true),isLoadingStateEnabled:!0,items:b,layout:"basic",loadItems:k,minCols:1,renderItem:K,scrollContainer:()=>c.current??window,virtualize:D})})})]})}var eB=t(292815);let eO=(void 0!==d||(d=t(473717)).hash&&"8250aa2ed9c603023c2f2a226d0b9fbb"!==d.hash&&console.error("The definition of 'VisualSearchImageContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function eN({cropArea:e,cropSource:a,descriptorModules:t,entrypoint:n,pinKey:l,trafficSource:i,viewParameter:r,viewType:s}){(0,m.useEffect)(()=>{(0,h.A)("VisualSearchImageContainer","/app/www/VisualSearch/VisualSearchImageContainer.tsx")},[]);let o=(0,e_.g)(),d=(0,ev.A)(),{imageContainerScrollTop:c,imageContainerScrollTopForPinId:u}=(0,eh.U)(),p=(0,m.useRef)(null),g=(0,m.useRef)(null),[y,_]=(0,m.useState)(0),[k,x]=(0,m.useState)(0),[S,b]=(0,m.useState)(0),{scrollCropperInView:w}=(0,eB.A)({scrollContainerRef:p}),A=(0,v.A)(eO,l),{defaultColor:F,selectedColor:P,hoveredColor:I,pressedColor:j}=(0,H.A)(A.dominantColor),C=520/(A?.image?.width??1)*(A?.image?.height??1),T=A?.image?.url??"",{onImageLoad:R}=Y({containerRef:g}),{isDescriptorAvailable:K,descriptorModuleHeight:D,descriptorBottomBorderRadius:E}=function({imageContainerRef:e,descriptorModules:a}){var t;let n,l,i=!!a?.length,r=64*!!i;return i&&e.current?{isDescriptorAvailable:i,descriptorModuleHeight:r,descriptorBottomBorderRadius:(n=(t=e.current).scrollTop,24*(61<(l=t.scrollHeight-t.clientHeight-n)&&l<67))}:{isDescriptorAvailable:i,descriptorModuleHeight:r,descriptorBottomBorderRadius:0}}({imageContainerRef:p,descriptorModules:t}),M=(0,m.useCallback)(()=>{let e=p.current;if(e){let{x:a,y:t}=e.getBoundingClientRect();_(a),x(t-e.scrollTop)}b(16*(C>=window.innerHeight-o&&!K))},[o,C,K]),z=(0,m.useCallback)(()=>{M(),c.current=p.current?.scrollTop||0,u.current=A.entityId},[M,A.entityId,c,u]);return(0,$.A)(()=>{let e=p.current;if(!e)return;let a=c.current,t=u.current;return 0!==a&&t===A.entityId&&(e.scrollTop=a),M(),window.addEventListener("mousemove",w),()=>{window.removeEventListener("mousemove",w)}}),(0,O.jsxs)(m.Fragment,{children:[(0,O.jsx)(f.az,{ref:p,bottom:!0,dangerouslySetInlineStyle:{__style:{top:o,insetInlineStart:d,height:`min(${C}px, calc(100vh - ${o}px))`,paddingBottom:`${S}px`,scrollbarWidth:"thin"}},"data-test-id":"visual-search-image-container",marginStart:4,onScroll:z,overflow:"auto",position:"fixed",width:536,children:(0,O.jsx)(f.az,{"data-test-id":"flashlight-enabled-image",height:C+D,width:520,children:(0,O.jsxs)(f.n1,{height:C,rounding:600,width:520,children:[(0,O.jsx)(L.A,{_enableViewTransitions:!0,type:"image",children:(0,O.jsx)(f.az,{ref:g,children:(0,O.jsx)(f._V,{alt:A.description??"",naturalHeight:C,naturalWidth:520,onLoad:R,src:T})})}),(0,O.jsx)(el,{cropArea:e,cropSource:a,entrypoint:n,imageContainerX:y,imageContainerY:k,imageSize:{height:C,width:520},pinKey:A,trafficSource:i,viewParameter:r,viewType:s})]})})}),(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{top:o,insetInlineStart:d}},"data-test-id":"visual-search-cancel-button-container",marginStart:6,marginTop:2,position:"fixed",children:(0,O.jsx)(q.A,{defaultPillColor:F,hoveredPillColor:I,pressedPillColor:j,viewParameter:r,viewType:s})}),K&&(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{top:`min(${o+C-D}px, calc(100vh - ${D}px))`,insetInlineStart:d,borderRadius:`0 0 ${E}px ${E}px`}},"data-test-id":"visual-search-descriptor-container",height:D,marginStart:4,overflow:"hidden",position:"fixed",width:520,children:(0,O.jsx)(G,{defaultPillColor:F,descriptorModules:t??[],hoveredPillColor:I,isWebImageSearchRedesign:!0,pinKey:A,pressedPillColor:j,selectedPillColor:P})}),(0,O.jsx)(f.az,{dangerouslySetInlineStyle:{__style:{boxSizing:"content-box"}},"data-test-id":"visual-search-image-container-placeholder",height:1,marginStart:4,minWidth:536})]})}let eV=(void 0!==c||(c=t(148963)).hash&&"3c3f391c3bf9eec79c18ed9a3fe63800"!==c.hash&&console.error("The definition of 'VisualSearchLayout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),c);function eU({cropArea:e,cropSource:a,entrypoint:t,isProductPage:n,oneBarModules:l,pinKey:i,searchId:r,descriptorModules:s,trafficSource:o,visualSearchFlashlightUnifiedResource:d}){(0,m.useEffect)(()=>{(0,h.A)("VisualSearchLayout","/app/www/VisualSearch/VisualSearchLayout.tsx")},[]);let c=(0,v.A)(eV,i),u=(0,x.A)(),{id:p}=(0,y.g)(),{pinId:g}=(0,w.A)(p??""),_=u.bt("Shop for similar", "Shop similar", "visualSearch.productPage.header", undefined, true),{viewType:k,viewParameter:S}=ef({cropSource:a}),b={commerce_data:JSON.stringify({is_product_only_feed:n,entrypoint:t})};return(0,O.jsx)(ey.A,{objectId:r,view:k,children:(0,O.jsxs)(em.A,{log:{aux_data:b,view_type:k,view_parameter:S,object_id_str:g},children:[n?(0,O.jsx)(E.A,{isProductPage:!0,title:_,viewParameter:S,viewType:k}):(0,O.jsx)(eb.A,{text:u.bt("Image search page", "Image Search Page", "imageSearch.accessibilityHiddenHeading", undefined, true)}),(0,O.jsxs)(f.so,{children:[!n&&(0,O.jsx)(eN,{cropArea:e,cropSource:a,descriptorModules:s,entrypoint:t,pinKey:c,trafficSource:o,viewParameter:S,viewType:k}),(0,O.jsx)(f.so.Item,{flex:"grow",children:(0,O.jsx)(e$,{auxData:b,isProductOnlyFeed:n,oneBarModules:l,trafficSource:o,viewParameter:S,viewType:k,visualSearchFlashlightUnifiedResource:d})})]})]})})}var eW=t(75731);let eG=(void 0!==u||(u=t(897853)).hash&&"ece11b62e2de551b92d24a2389316249"!==u.hash&&console.error("The definition of 'VisualSearchPageWithPinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),u);function eH({pinKey:e}){let a,t,n=(0,y.zy)(),l=(0,v.A)(eG,e),i=(0,K.f)(),r=(0,I.A)(),s=r?.isAuth??!1,{getNormalizedPinImage:o}=(0,j.A)({pinKey:l,maxWidth:i?520:446}),{cropSource:d,entrypoint:c,full_feed_title:u="",filters:p,hybrid_search_param:g,journey_depth:h,search_query:f,source_module_id:_,selected_descriptors:k,requestParams:x,rs:S}=(0,C.A)(n.search);if(i)t=520/(l?.image?.width??1)*(l?.image?.height??1),a=520;else{let{height:e,width:n}=o();t=e,a=n}let b=(0,m.useMemo)(()=>(0,F.A)(n,a,t)??{x:0,y:0,w:a,h:t},[n,a,t]),w=(0,T.A)(Number(d))||5,A=n.pathname.includes("/products"),E=n.state?.clientNavigation===!0,L=(0,eW.V)(c)?c:"unknown",M=E?L:"deep_link";(0,D.A)({entrypoint:c,isAuthenticated:s});let{searchId:z,visualSearchFlashlightUnifiedResource:$,oneBarModules:B,descriptorModules:N}=(0,P.A)({resourceOptions:{crop:(0,R.A)({cropArea:b,scaledWidth:a,scaledHeight:t}),crop_source:w,entry_source:A?"shopping":"flashlight",entrypoint:M,field_set_key:"shopping_grid_item",image_signature:l.imageSignature||void 0,is_shopping:A,pin_id:l.entityId,request_params:x,source:S,filters:p,hybrid_search_param:g,selected_descriptors:k,journey_depth:parseInt(h,10)||void 0,search_query:f,source_module_id:_}});return l?(0,O.jsx)(i?eU:eS,{cropArea:b,cropSource:w,descriptorModules:N,entrypoint:M,isProductPage:A,oneBarModules:B,pinKey:l,searchId:z,title:u,trafficSource:S,visualSearchFlashlightUnifiedResource:$}):null}function eJ({pinKey:e}){return(0,m.useEffect)(()=>{(0,h.A)("VisualSearchPageWithPinData","/app/www/VisualSearch/VisualSearchPageWithPinData.tsx")},[]),(0,O.jsx)(K.x,{children:(0,O.jsx)(eH,{pinKey:e})})}let eY=(void 0!==p||(p=t(928121)).hash&&"0f7b98a1f02dbf8528df0452aa26efd4"!==p.hash&&console.error("The definition of 'RelatedProductsPageQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),p),eq=(void 0!==g||(g=t(713055)).hash&&"91d05676e413b7b47653c2f8fa609093"!==g.hash&&console.error("The definition of 'RelatedProductsPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),g);function eQ({pinId:e,relatedProductsDataRef:a}){let t=(0,x.A)(),n=(0,k.A)({strategy:"Legacy",query:eY,variables:{pinId:e},useGetLegacyData:()=>{let{data:e}=(0,S.A)(a);return e}}),l=n?.v3GetPinQuery?.__typename==="V3GetPin"?n.v3GetPinQuery.data:null,i=(0,v.A)(eq,l);return(0,O.jsx)(m.Suspense,{fallback:(0,O.jsx)(f.y$,{accessibilityLabel:t.bt("Loading Pin data", "Loading Pin data", "RelatedProductsPage.loadingPinData", undefined, true),show:!0}),children:i&&(0,O.jsx)(eJ,{pinKey:i})})}function eX(){(0,m.useEffect)(()=>{(0,h.A)("RelatedProductsPage","/app/www/pages/authDesktop/RelatedProductsPage.tsx")},[]);let{id:e=""}=(0,y.g)(),{pinId:a}=(0,w.A)(e),{ref:t}=(0,b.A)({name:"PinResource",options:{id:a,field_set_key:"detailed"}});return(0,O.jsx)(_.A,{name:"RelatedProductsPage_RelatedProductsPageWrapper",children:(0,O.jsx)(m.Suspense,{fallback:(0,O.jsx)(A.A,{}),children:(0,O.jsx)(eQ,{pinId:a,relatedProductsDataRef:t})})})}},639710(e,a,t){t.d(a,{$:()=>m,A:()=>v});var n=t(131321),l=t(364107),i=t(174256),r=t(813985),s=t(300722),o=t(201408),d=t(180152),c=t(504252);let u=new Set(["PinResource","RepinResource"]),p={ApiResource:e=>e?.url==="/v3/orientation/nux_creator_recommendations/"?"nux-creator-recommendations":e?.url==="/v3/users/me/interests/"?`recommended-interests:${e.data?.blend_type}`:e?.url===`/v3/usecases/${e.data?.use_case_id}/feed/`?"useCaseFeed":e?.url===`/v3/boards/${e.data?.board_id}/automagical/pins/`?`automagical-board-feed:${e.data?.board_id}`:e?.url===`/v3/aggregated_pin_data/${e.data?.aggregated_pin_data}/comments/`?`aggregated-comments:${e.data?.aggregated_pin_data}`:e?.url==="/v3/users/me/boards/archived/"?"archived-boards":"",AggregatedActivityFeedResource:e=>`trieditfeed:${e.aggregated_pin_data_id}`,AggregatedCommentReplyFeedResource:e=>`${c.A.AGGREGATED_COMMENT_REPLIES}:${e.objectId}`,BoardlessPinsResource:e=>`boardless-pins:${e.userId}`,BestPinsFeedAltResource:e=>`idea-page-best-pins:${e.interest}`,BoardContentRecommendationResource:e=>`recommendation-feed:${e.id}`,BoardFeedResource:e=>`boardfeed:${e.board_id}`,BoardSectionsRepinResource:e=>`board-sections:${e.board_id}`,BoardSectionsResource:e=>`board-sections:${e.board_id}`,BoardSectionPinsResource:e=>`board-section-pins:${e.section_id}`,BoardsFeedResource:e=>`profile-boards:${e.username}`,BoardToolsFeedResource:e=>`board-tools:${e.boardId}`,ConversationsResource:()=>"conversations",DidItUserFeedResource:e=>`profile-tried:${e.username}`,InterestResource:e=>`klp-pins:${e.interest}`,MoreIdeasTabsBoardsResource:()=>"homefeed-more-ideas-tabs",NewsHubResource:()=>"notifications",NewsHubDetailsResource:e=>`newshubdetail:${e.news_id}`,NuxInterestsResource:()=>"nuxTopics",PinsFromBrandResource:e=>`brand-pins:${e.pin}`,ReactionsResource:e=>`reactions:${e.pin_id}`,RelatedArticlesResource:e=>`related-articles:${e.article_id}`,RelatedModulesResource:e=>`related-modules:${e.pin_id}`,RelatedPinFeedResource:e=>`related-pins:${e.pin}`,RelatedStreamResource:e=>`related-story-pins:${e.pinId}`,SearchResource:e=>`search:${(0,r.n1)(e)}`,BaseSearchResource:e=>`search:${(0,r.n1)(e)}`,SectionToolsFeedResource:e=>`section-tools:${e.sectionId}`,ShareSuggestionsTypeaheadResource:e=>`share-suggestions:${e.board||e.user}:${e.term}`,StoryFeedResource:e=>`story-feed:${e.feed_type}:${e.request_params}`,StoryPinTaggedProductsResource:()=>"story-pin-tagged-products",TodayArticleFeedResource:e=>`today-article:${e.id}`,TodayTabInterestFeedResource:e=>`today-article-interestfeed:${e.interest_id}`,TodayTabResource:()=>"today-tab",SeoTier1CandidateResource:()=>"tier1-feed",UnifiedCommentsResource:e=>`unified-comments:${e.aggregated_pin_id}`,UserActivityPinsResource:e=>`profile-pins-feed:${e.user_id}`,UserHomefeedResource:e=>e.pin_quiz?"pin-quiz":"homefeed",UserFollowingResource:e=>`user-following:${e.username}`,UserRecentActivityResource:e=>`user-recent-activity:${e.filter_type}`,UserStoryPinsFeedResource:e=>`story-pins-feed:${e.user_id}`,VisualLiveSearchResource:e=>`visual-search:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualLiveSearchProductFeedResource:e=>`visual-search-products:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualSearchFlashlightUnifiedResource:e=>`related-products-unified:${e.pin_id}`,InterestFollowingResource:e=>`topic-following:${e.username}`,UserPinsResource:e=>`profile-pins:${e.username}`,TopicFeedResource:e=>e.best_pins?`best-topic-pins:${e.interest}`:`topic-pins:${e.interest}`},g={AggregatedActivityFeedResource:({options:{aggregated_pin_data_id:e}})=>({type:c.A.TRIED_IT_FEED,id:e}),AggregatedCommentReplyFeedResource:({options:{isUnifiedComment:e,objectId:a}})=>({type:e?c.A.AGGREGATED_COMMENT_REPLIES:c.A.AGGREGATED_COMMENTS,id:a,reversed:!0}),ApiResource:({options:{url:e,data:a}})=>e===`/v3/usecases/${a?.use_case_id}/feed/`?{type:c.A.USE_CASE_TAB,id:a.use_case_id}:e===`/v3/boards/${a?.board_id}/automagical/pins/`?{type:c.A.AUTOMAGICAL_BOARD_FEED,id:a.board_id}:e===`/v3/aggregated_comments/${a.aggregated_comment}/replies/`?{type:a.isUnifiedComment?c.A.AGGREGATED_COMMENT_REPLIES:c.A.AGGREGATED_COMMENTS,id:a.aggregated_comment,reversed:!0}:e===`/v3/aggregated_pin_data/${a?.aggregated_pin_data}/comments/`?{type:c.A.AGGREGATED_COMMENTS,id:a.aggregated_pin_data}:null,BoardFeedResource:({options:{board_id:e}})=>({type:c.A.BOARDFEED,id:e}),BoardlessPinsResource:({options:{userId:e}})=>({type:c.A.BOARDLESS_PINS,id:e}),BoardSectionPinsResource:({options:{section_id:e}})=>({type:c.A.BOARD_SECTION_PINS,id:e}),BoardSectionsResource:({options:{board_id:e}})=>({type:c.A.BOARD_SECTIONS,id:e}),BoardsResource:({options:{username:e,sort:a,filter_types:t}})=>({type:c.A.PROFILE_BOARDS,id:(0,s.A)(e,a,t)}),BaseSearchResource:({options:e,response:a})=>({type:c.A.SEARCH_PINS,id:(0,r.n1)(e),items:a.resource_response.data?.results||[]}),DidItCommentsResource:({options:{objectId:e}})=>({type:c.A.AGGREGATED_COMMENTS,id:e,reversed:!0}),DidItUserFeedResource:({options:{username:e}})=>({type:c.A.TRIED_IT_FEED,id:e}),RelatedArticlesResource:({options:{article_id:e}})=>({type:c.A.TODAY_TAB,id:e}),StoryPinDraftsResource:({options:{userId:e}})=>({type:c.A.STORY_PIN_DATA,id:e}),TodayTabInterestFeedResource:({options:{interest_id:e}})=>({type:c.A.TODAY_ARTICLE_INTEREST_FEED,id:e}),TodayTabResource:()=>({type:c.A.TODAY_TAB,id:"todayTab"}),UnifiedCommentsPreviewResource:({options:{aggregated_pin_id:e}})=>({type:c.A.UNIFIED_COMMENTS,id:e}),UnifiedCommentsResource:({options:{aggregated_pin_id:e,is_reversed:a}})=>({type:c.A.UNIFIED_COMMENTS,id:e,reversed:a}),UserActivityPinsResource:({options:{user_id:e}})=>({type:c.A.PROFILE_PINS_FEED,id:e}),UserStoryPinsFeedResource:({response:e,options:{user_id:a}})=>({type:c.A.STORY_PINS_FEED,id:a,items:e.resource_response.data||[]})},h=(e,{pinId:a,oldFeedId:t,newFeedId:n})=>t===n?e:((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:[{type:"pin",id:a},...e[t]]}:e)(((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:e[t].filter(e=>"pin"!==e.type||e.id!==a)}:e)(e,{pinId:a,feedId:t}),{pinId:a,feedId:n}),m=(e,a)=>(0,n.A)(p,e)?p[e](a):null,y=(e,a)=>a?`board-section-pins:${a}`:`boardfeed:${e}`,f=(e,a)=>e.map(e=>{let{id:t,schema:n,type:l}=e;return"home_feed_tabs"===l?e:n?{id:t,type:n,trackingParams:"pin"===n?a.pins[t].tracking_params:void 0,user_id:void 0}:null}).filter(Boolean),_=(e,a,t)=>Object.keys(e).reduce((n,l)=>{let i=e[l]||[],r=i.filter(e=>{if(e.type!==a)return!0;if("reaction"===a){let a=e.id.lastIndexOf(":");return e.id.substring(0,a)!==t}return e.id!==t});return i.length!==r.length&&(n[l]=r),n},{...e}),v=(e={},a)=>{switch(a.type){case i.v6:case i.LB:{let{payload:t}=a,{resource:l,options:r,normalizedResponse:s,schema:u}=t;if(s&&(0,n.A)(p,l)){let t=((e,a,t)=>{let n=t||o.A[e];if(n===d.hm)return a.result;if(n===d.IL)return a.result.map(e=>({id:e,schema:"board"}));if(n===d.Xm)return a.result.map(e=>({id:e,schema:"user"}));if(n===d.D$)return a.result.map(e=>({id:e,schema:"invite"}));if(n===d.d9)return a.result.map(e=>({id:e,schema:"reaction"}));if("object"==typeof n){let e=Object.entries(n).find(([,e])=>e===d.hm);if(e)return a.result[e[0]]}return null})(l,s,u);if(t&&Array.isArray(t)){let n=p[l](r);if(!n)return e;if("BoardToolsFeedResource"===l||"SectionToolsFeedResource"===l)return{...e,[n]:t};if("UnifiedCommentsResource"===l){let l=f(t,s.entities);if(e[n]&&(i.v6||i.LB===a.type))return{...e,[n]:[...e[n],...l]};return{...e,[n]:l}}{let l=[...a.type===i.LB&&e[n]||[],...f(t,s.entities)];return{...e,[n]:l}}}}else{let{data:n}=t.response.resource_response;if(!t.options?.redux_normalize_feed)return e;let l=g[t.resource]({options:t.options,response:t.response});if(l){let{type:t,id:r,items:s,reversed:o}=l,d=(s||n||[]).filter(Boolean).map(e=>((e,a)=>{switch(e.type){case"story":return{id:e.id??"",type:"story",story_type:e.story_type??""};case"module":return{id:e.id,type:"module",name:e.name};case"user":return{id:e.id,type:"user"};case"board":return a===c.A.PROFILE_BOARDS?{id:e.id,type:"board",onProfile:!0,profileGroup:e.archived_by_me_at?"archived":e.privacy||"public"}:{id:e.id,type:"board",onProfile:!1};case"board_section":return{type:"boardsection",id:e.id};case"triedit":return{type:"triedit",id:e.id};case"aggregatedcomment":return{type:"aggregatedcomment",id:e.id};case"home_feed_tab":return{type:"home_feed_tab",id:e.id,name:e.name};case"storypindata":return{id:e.id,type:"storypindata"};case"todayarticle":return{type:"todayarticle",id:e.id};case"unifiedcommentspreview":return"userdiditdata"===e.unified_comment.type?{type:"triedit",id:e.unified_comment.id}:{type:"aggregatedcomment",id:e.unified_comment.id};default:let t="useCaseFeed"===a&&"tracking_params"in e;return{type:"pin",id:e.id??"",...t&&{trackingParams:e.tracking_params}}}})(e,t));o&&(d=d.reverse());let u=`${t}:${r}`,p=e[u];if(p||a.type!==i.LB){let t=p||[],n=d;return a.type===i.LB&&(n=o?d.concat(t):t.concat(d)),{...e,[u]:n}}}}break}case"FEED_ITEM_REORDERED":{let{payload:{feedType:t,feedId:n,itemType:i,targetItemId:r,sourceItemId:s}}=a,o=`${t}:${n}`,d=e[o]||[],u=-1,p=-1;if([c.A.BOARDFEED,c.A.BOARD_SECTION_PINS,c.A.BOARD_SECTIONS,"profileBoards"].includes(t)&&(u=d.findIndex(e=>e.type===i&&e.id===s),p=d.findIndex(e=>e.type===i&&e.id===r)),-1!==u&&-1!==p)return{...e,[o]:(0,l.A)(d,u,p)};break}case"FEED_ITEMS_REMOVED":{let{payload:{feedType:t,feedId:n,inverseSelection:l,itemType:i,itemIds:r=[]}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&o.length>0&&(t===c.A.BOARD_SECTION_PINS||t===c.A.BOARDFEED)){let a=o.filter(e=>{let a=r.includes(e.id);return!(e.type===i&&(l&&!a||!l&&a))}),t=!!a.find(e=>"pin"===e.type);return{...e,[s]:t?a:[]}}if(o&&o.length>0&&t===c.A.BOARD_SECTIONS||o&&o.length>0&&(t===c.A.AGGREGATED_COMMENTS||t===c.A.BOARDLESS_PINS||t===c.A.PROFILE_PINS_FEED||t===c.A.STORY_PINS_FEED||t===c.A.UNIFIED_COMMENTS||t===c.A.TRIED_IT_FEED||t===c.A.STORY_PIN_DATA)){let a=o.filter(e=>{let a=r.includes(e.id);return!(e.type===i&&a)});return{...e,[s]:a}}break}case"FEED_ITEMS_ADDED":{let{payload:{feedType:t,feedId:n,itemType:l,itemIds:i=[],prepend:r}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&(t===c.A.BOARD_SECTION_PINS||t===c.A.BOARDFEED||t===c.A.BOARDLESS_PINS)){let a=i.map(e=>({id:e,type:l})),t=0;"story"===(o[0]||{}).type&&(t=1),"story"===(o[1]||{}).type&&(t=2);let n=[...o.slice(0,t),...a,...o.slice(t)];return{...e,[s]:n}}if(o&&t===c.A.BOARD_SECTIONS){let a=[...i].reverse().map(e=>({id:e,type:"boardsection"})),t=o?[...a,...o]:[...a];return{...e,[s]:t}}if(t===c.A.AGGREGATED_COMMENTS||t===c.A.AGGREGATED_COMMENT_REPLIES||t===c.A.PROFILE_PINS_FEED||t===c.A.STORY_PINS_FEED||t===c.A.UNIFIED_COMMENTS){let a=i.map(e=>({id:e,type:l})),t=o?[...r?a:o,...r?o:a]:a;return{...e,[s]:t}}if(t===c.A.TRIED_IT_FEED){let a=i.map(e=>({id:e,type:l})),t=o?[...a,...o]:a;return{...e,[s]:t}}break}case"FEED_INVALIDATE":{let{payload:{feedType:t,feedId:n}}=a,l=`${t}:${n}`;return e[l],{...e,[l]:null}}case"APPEND_FEED_ITEMS":{let{payload:{id:t,items:n,options:l}}=a,i=e[t];if(!i)return{...e,[t]:n};{let a;return a=l.isPrepend?i[0]&&"story"===i[0].type?[].concat(i[0],n,i.slice(1)):n.concat(i):i.concat(n),{...e,[t]:a}}}case"PIN_DELETE":{let{payload:{pinId:t}}=a;return _(e,"pin",t)}case"BOARD_ARCHIVE":{let{payload:{boardId:t,username:n}}=a,l=`profile-boards:${n??""}`;if(e[l])return{...e,[l]:e[l].filter(e=>e.id!==t)};break}case"BOARD_UNARCHIVE":{let{payload:{boardId:t}}=a,n="archived-boards";if(e[n])return{...e,[n]:e[n].filter(e=>e.id!==t)};break}case"BOARD_DELETE":{let{payload:{boardId:t}}=a;return _(e,"board",t)}case"BOARD_SECTION_DELETE":{let{payload:{boardSectionId:t}}=a;return _(e,"boardsection",t)}case"PINS_MOVE":{let{payload:{source:t,target:n,pinIds:l,userId:i}}=a,r=t.boardlessPins&&i&&`boardless-pins:${i}`||t.boardId&&y(t.boardId,t.sectionId),s=y(n.boardId,n.sectionId);return l.reduce((e,a)=>h(e,{pinId:a,oldFeedId:r,newFeedId:s}),e)}case"PINS_MOVE_ALL":{let{payload:{source:t,target:n,excludePinIds:l}}=a,i=y(t.boardId,t.sectionId),r=y(n.boardId,n.sectionId),s={...e,[i]:l.map(e=>({type:"pin",id:e}))};return delete s[r],s}case"PIN_EDIT":{let{payload:{pinId:t,boardId:n,sectionId:l="",source:{boardId:i,sectionId:r}}}=a;return h(e,{pinId:t,oldFeedId:y(i,r),newFeedId:y(n,l)})}case i.lI:if(u.has(a.payload.resource)){let t,n=a.payload.response.resource_response.data,{board:l}=n;if("quick_saves"===l.layout)t=`boardless-pins:${a.payload.options.user_id}`;else{let e=a.payload.options.section;t=e?`board-section-pins:${e}`:`boardfeed:${l.id}`}if(e[t]){let a={...e},l={id:n.id,type:"pin",trackingParams:n?.tracking_params};return a[t]=[l].concat(e[t]),a}}if("BoardSectionResource"===a.payload.resource&&a.payload.normalizedResponse){let t=a.payload.normalizedResponse.result,n=a.payload.normalizedResponse.entities.boardsections?.[t].board;if(!n)return e;let l=`board-sections:${n}`;if(e[l]){let a={...e};return a[l]=[{id:t,type:"boardsection"}].concat(e[l]),a}}if("AggregatedCommentResource"===a.payload.resource&&a.payload.normalizedResponse){let t={id:a.payload.normalizedResponse.result,type:"aggregatedcomment"},n={...e};for(let l of["aggregated-comments","unified-comments"]){let i=`${l}:${a.payload.options.objectId}`;e[i]&&(n={...n,[i]:[t].concat(n[i])})}return n}if("AggregatedCommentReplyResource"===a.payload.resource&&a.payload.normalizedResponse){let t=`${c.A.AGGREGATED_COMMENT_REPLIES}:${a.payload.options.objectId}`;return{...e,[t]:[...e[t]||[],{id:a.payload.normalizedResponse.result,type:"aggregatedComment"}]}}if("ReactionsResource"===a.payload.resource&&a.payload.normalizedResponse){let{reaction_pin_id:t,reaction_type:n}=a.payload.options;if("reaction"===a.payload.options.action_type){let l=`reactions:${a.payload.options.pin_id}`,i={...e},r={id:`${t}:${a.payload.options.user_id}:${n}`,type:"reaction",trackingParams:void 0};return i[l]=[r].concat(e[l]),i}if("unreaction"===a.payload.options.action_type)return _(e,"reaction",`${t}:${a.payload.options.user_id}`)}}return e}},270018(e,a,t){t.r(a),t.d(a,{default:()=>v});var n=t(61163),l=t(859471),i=t(106386),r=t(979638),s=t(19821),o=t(706114),d=t(743372),c=t(676692),u=t(201593),p=t(538329),g=t(115795),h=t(998556),m=t(752159),y=t(67765),f=t(971289),_=t(562615);function v({alignIconLeft:e,bgColor:a,color:t,disableRedirect:v=!1,fallbackUrl:k,icon:x="chevron-left",onTouch:S,padding:b,placement:w,shouldUseFallbackUrl:A,size:F="lg",viewParameter:P,viewType:I,isVisualSearch:j,fallbackUrlOptions:C}){(0,l.useEffect)(()=>{(0,n.A)("BackButton","/app/www/routing/BackButton.tsx")},[]);let T=(0,p.A)(),R=(0,r.Zp)(),K=(0,r.zy)(),D=(0,f.qJ)(),E=(0,i.d4)(e=>e.session.isAuthenticated),L=(0,d.A)(),M=(0,y.A)(),{isDarkMode:z}=(0,u.D2)(),{viewType:$,viewParameter:B}=(0,c.WQ)(),[O,N]=I?[I,P]:[$,B],V=()=>{let e=(0,h.y1)().getItem(o.rt);K.key||"/ideas"!==k?(0,m.PM)(`pinner_conversion.back_button.${String(e?.[0].pageType)}`):(0,m.PM)("pinner_conversion.back_button.no_history"),(0,m.PM)(`web_back_button_click.${String(w)}.is_auth_${String(E)}`),M({action:"click",item:"back-button"}),O&&L({view_type:O,view_parameter:N,element:34,event_type:102}),S&&S(),v||((!K.key||K.state&&"redirect"===K.state.referrer||A)&&k?R(k,C):K.pathname.includes("/password/reset/")&&K.search&&K.search.includes("?nativeShouldDismiss=true")?R("/login/?dismissWebview=true"):R(-1))},U=z?u.fO:"white",W=(0,g.iK)(K)||j||"inverse"===t;return(0,_.jsx)(s.az,{"data-test-id":"back-button",children:e?(0,_.jsx)(s.az,{alignItems:"center",display:"flex",height:48,marginStart:"close"===x?-1:-2,width:48,children:(0,_.jsx)(s.K0,{accessibilityLabel:T.bt("Back", "Back", "navigation button", undefined, true),bgColor:a,icon:x,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"subtle":t,onClick:V,padding:"auto"!==b?b:2,size:F})}):(0,_.jsx)(s.az,{dangerouslySetInlineStyle:{__style:{backgroundColor:D||W||a?"":U,width:z&&!W?"fit-content":""}},rounding:"circle",children:(0,_.jsx)(s.K0,{accessibilityLabel:T.bt("Back", "Back", "navigation button", undefined, true),bgColor:a||D?a:"transparent",icon:x,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"subtle":t,onClick:V,padding:"auto"!==b?b:2,size:F})})})}},75731(e,a,t){t.d(a,{V:()=>n});function n(e){return"string"==typeof e&&e in{unknown:0,shop_the_look_module:1,feed_module:2,stela_landing_page_category_filter:3,hybrid_search_filter:4,board_shop_the_look_module:5,closeup_cta:6,image_tap:7,long_press:8,deep_link:9,p2z:10,closeup_long_press:11,closeup_descriptor:12,image_signature:13,closeup_image_cutout:14,stl_landing_page:15,stl_landing_page_object:16,related_feed_visual_search_module:17}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/64618.en_GB-2e15539f443e9d21.mjs.map